<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>An Introduction to Statistical and Data Sciences via R</title>
  <meta name="description" content="An open-source and fully-reproducible electronic textbook bridging the gap between traditional introductory statistics and data science courses.">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="An Introduction to Statistical and Data Sciences via R" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="http://moderndive.com/" />
  <meta property="og:image" content="http://moderndive.com/images/logos/book_cover.png" />
  <meta property="og:description" content="An open-source and fully-reproducible electronic textbook bridging the gap between traditional introductory statistics and data science courses." />
  <meta name="github-repo" content="moderndive/moderndive_book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="An Introduction to Statistical and Data Sciences via R" />
  
  <meta name="twitter:description" content="An open-source and fully-reproducible electronic textbook bridging the gap between traditional introductory statistics and data science courses." />
  <meta name="twitter:image" content="http://moderndive.com/images/logos/book_cover.png" />

<meta name="author" content="Chester Ismay and Albert Y. Kim">


<meta name="date" content="2018-03-29">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <link rel="apple-touch-icon-precomposed" sizes="152x152" href="images/logos/favicons/apple-touch-icon.png">
  <link rel="shortcut icon" href="images/logos/favicons/favicon.ico" type="image/x-icon">
<link rel="prev" href="index.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-89938436-1', 'auto');
  ga('send', 'pageview');

</script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#sec:intro-for-students"><i class="fa fa-check"></i><b>1.1</b> Introduction for students</a><ul>
<li class="chapter" data-level="1.1.1" data-path="index.html"><a href="index.html#subsec:learning-goals"><i class="fa fa-check"></i><b>1.1.1</b> What you will learn from this book</a></li>
<li class="chapter" data-level="1.1.2" data-path="index.html"><a href="index.html#subsec:pipeline"><i class="fa fa-check"></i><b>1.1.2</b> Data/science pipeline</a></li>
<li class="chapter" data-level="1.1.3" data-path="index.html"><a href="index.html#subsec:reproducible"><i class="fa fa-check"></i><b>1.1.3</b> Reproducible research</a></li>
<li class="chapter" data-level="1.1.4" data-path="index.html"><a href="index.html#final-note-for-students"><i class="fa fa-check"></i><b>1.1.4</b> Final note for students</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#sec:intro-instructors"><i class="fa fa-check"></i><b>1.2</b> Introduction for instructors</a><ul>
<li class="chapter" data-level="1.2.1" data-path="index.html"><a href="index.html#who-is-this-book-for"><i class="fa fa-check"></i><b>1.2.1</b> Who is this book for?</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#sec:connect-contribute"><i class="fa fa-check"></i><b>1.3</b> Connect and contribute</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#sec:about-book"><i class="fa fa-check"></i><b>1.4</b> About this book</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#sec:about-authors"><i class="fa fa-check"></i><b>1.5</b> About the authors</a></li>
</ul></li>
<li class="part"><span><b>I Inference via infer</b></span></li>
<li class="chapter" data-level="2" data-path="2-sampling.html"><a href="2-sampling.html"><i class="fa fa-check"></i><b>2</b> Sampling</a><ul>
<li class="chapter" data-level="" data-path="2-sampling.html"><a href="2-sampling.html#needed-packages"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="2.1" data-path="2-sampling.html"><a href="2-sampling.html#sampling-bowl"><i class="fa fa-check"></i><b>2.1</b> Sampling bowl</a><ul>
<li class="chapter" data-level="2.1.1" data-path="2-sampling.html"><a href="2-sampling.html#general-sampling-terminology"><i class="fa fa-check"></i><b>2.1.1</b> General sampling terminology</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="2-sampling.html"><a href="2-sampling.html#tactile"><i class="fa fa-check"></i><b>2.2</b> Tactile sampling from bowl</a><ul>
<li class="chapter" data-level="2.2.1" data-path="2-sampling.html"><a href="2-sampling.html#tactilely-using-shovel-once"><i class="fa fa-check"></i><b>2.2.1</b> Tactilely using shovel once</a></li>
<li class="chapter" data-level="2.2.2" data-path="2-sampling.html"><a href="2-sampling.html#tactilely-using-shovel-33-times"><i class="fa fa-check"></i><b>2.2.2</b> Tactilely using shovel 33 times</a></li>
<li class="chapter" data-level="2.2.3" data-path="2-sampling.html"><a href="2-sampling.html#sampling-distribution"><i class="fa fa-check"></i><b>2.2.3</b> Sampling distribution</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="2-sampling.html"><a href="2-sampling.html#virtual-sampling-from-bowl"><i class="fa fa-check"></i><b>2.3</b> Virtual sampling from bowl</a><ul>
<li class="chapter" data-level="2.3.1" data-path="2-sampling.html"><a href="2-sampling.html#virtually-using-shovel-once"><i class="fa fa-check"></i><b>2.3.1</b> Virtually using shovel once</a></li>
<li class="chapter" data-level="2.3.2" data-path="2-sampling.html"><a href="2-sampling.html#virtually-using-shovel-33-times"><i class="fa fa-check"></i><b>2.3.2</b> Virtually using shovel 33 times</a></li>
<li class="chapter" data-level="2.3.3" data-path="2-sampling.html"><a href="2-sampling.html#virtually-using-shovel-1000-times"><i class="fa fa-check"></i><b>2.3.3</b> Virtually using shovel 1000 times</a></li>
<li class="chapter" data-level="2.3.4" data-path="2-sampling.html"><a href="2-sampling.html#comparing-sampling-distributions"><i class="fa fa-check"></i><b>2.3.4</b> Comparing sampling distributions</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="2-sampling.html"><a href="2-sampling.html#central-limit-theorem"><i class="fa fa-check"></i><b>2.4</b> Central Limit Theorem</a></li>
<li class="chapter" data-level="2.5" data-path="2-sampling.html"><a href="2-sampling.html#conclusion"><i class="fa fa-check"></i><b>2.5</b> Conclusion</a><ul>
<li class="chapter" data-level="2.5.1" data-path="2-sampling.html"><a href="2-sampling.html#whats-to-come"><i class="fa fa-check"></i><b>2.5.1</b> What’s to come?</a></li>
<li class="chapter" data-level="2.5.2" data-path="2-sampling.html"><a href="2-sampling.html#script-of-r-code"><i class="fa fa-check"></i><b>2.5.2</b> Script of R code</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">An Introduction to Statistical and Data Sciences via R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<html>
<img src='http://moderndive.com/images/logos/wide_format.png' alt="ModernDive">
</html>
<div id="sampling" class="section level1">
<h1><span class="header-section-number">2</span> Sampling</h1>
<p>In this chapter we kick off the third segment of this book, statistical inference, by learning about <strong>sampling</strong>. The concepts behind sampling form the basis of confidence intervals and hypothesis testing, which we’ll cover in Chapters <a href="#ci"><strong>??</strong></a> and <a href="#hypo"><strong>??</strong></a> respectively. We will see that the tools that you learned in the data science segment of this book (data visualization, “tidy” data format, and data wrangling) will also play an important role here in the development of your understanding. As mentioned before, the concepts throughout this text all build into a culmination allowing you to “think with data.”</p>
<div id="needed-packages" class="section level3 unnumbered">
<h3>Needed packages</h3>
<p>Let’s load all the packages needed for this chapter (this assumes you’ve already installed them). If needed, read Section <a href="#packages"><strong>??</strong></a> for information on how to install and load R packages.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(dplyr)
<span class="kw">library</span>(ggplot2)
<span class="kw">library</span>(moderndive)
<span class="co"># For loading CSV files:</span>
<span class="kw">library</span>(readr)</code></pre></div>
</div>
<div id="sampling-bowl" class="section level2">
<h2><span class="header-section-number">2.1</span> Sampling bowl</h2>
<p>Let’s start this chapter with a sampling exercise. Imagine you are given a large bowl with 2400 balls that are either red, white, or green. We are interested in the proportion of balls in this bowl that are red, but are too lazy to do an exhaustive count. You are also given a “shovel” that you can insert into this bowl…</p>
<div class="figure" style="text-align: center"><span id="fig:sampling-exercise-1"></span>
<img src="images/sampling_bowl_2.jpg" alt="A bowl with 2400 balls" width="600px" />
<p class="caption">
Figure 2.1: A bowl with 2400 balls
</p>
</div>
<p>… and extract a sample of <span class="math inline">\(n=50\)</span> balls:</p>
<div class="figure" style="text-align: center"><span id="fig:sampling-exercise-2"></span>
<img src="images/sampling_bowl_3_cropped.jpg" alt="A shovel used to extract a sample of size n = 50" width="600px" />
<p class="caption">
Figure 2.2: A shovel used to extract a sample of size n = 50
</p>
</div>
<div id="general-sampling-terminology" class="section level3">
<h3><span class="header-section-number">2.1.1</span> General sampling terminology</h3>
<p>Before we proceed, let’s define some terminology:</p>
<ol style="list-style-type: decimal">
<li><strong>Population</strong>: The population is a set of <span class="math inline">\(N\)</span> observations we are interested in.
<ul>
<li>In our example, its the bowl of <span class="math inline">\(N=2400\)</span> balls.</li>
</ul></li>
<li><strong>Population parameter</strong>: A population parameter is a numerical summary measure about the population.
<ul>
<li>In our example, it’s the true <em>population proportion <span class="math inline">\(p\)</span></em> of the balls in the bowl that are red.</li>
</ul></li>
<li><strong>Census</strong>: An exhaustive enumeration/counting of all observations in the population used to compute the population parameter <em>exactly</em>, much like the Decennial United States census attempts to exhaustively count the US population.
<ul>
<li>In our example, this would correspond to exhaustively counting all red balls of the <span class="math inline">\(N=2400\)</span> total balls and computing <span class="math inline">\(p\)</span> exactly.</li>
<li>When <span class="math inline">\(N\)</span> is small, a census is feasible. However, when <span class="math inline">\(N\)</span> is large census can get very expensive, either in terms of time, energy, or money.</li>
</ul></li>
<li><strong>Sampling</strong>: Collecting a subset of size <span class="math inline">\(n \leq N\)</span> of observations from the population. Typically <span class="math inline">\(n\)</span> is much smaller than <span class="math inline">\(N\)</span>.
<ul>
<li>In our example, this corresponds to using the shovel to extract a sample of <span class="math inline">\(n=50\)</span> balls.</li>
</ul></li>
<li><strong>Representative sampling</strong>: A sample is said be a representative sample if it “looks like the population”.
<ul>
<li>In other words, the characteristics of sample’s observations are a good representation of the characteristics of the population’s observations.</li>
<li>In our example, this means does our sample of <span class="math inline">\(n=50\)</span> balls “look like” the contents of the bowl?</li>
</ul></li>
<li><strong>Point estimates/sample statistics</strong>: A summary statistic based on the sample of size <span class="math inline">\(n\)</span> that <em>estimates</em> the population parameter.
<ul>
<li>In our example, it’s the <em>sample proportion <span class="math inline">\(\widehat{p}\)</span></em> of the balls in the sample of <span class="math inline">\(n=50\)</span> balls that are red.</li>
<li>Key: The sample proportion <span class="math inline">\(\widehat{p}\)</span> is an estimate of the population proportion <span class="math inline">\(p\)</span>.</li>
</ul></li>
<li><strong>Generalizability</strong>: We say a sample is generalizable if any results of based on the sample can generalize to the population.
<ul>
<li>In our example, is <span class="math inline">\(\widehat{p}\)</span> a “good guess” of <span class="math inline">\(p\)</span>?</li>
<li>In other words, can we <em>infer</em> about the population based on our sample?</li>
</ul></li>
<li><strong>Bias</strong>: In a statistical sense, we say bias occurs if certain observations of a population have a higher chance of being sampled than others. We say a sampling procedure is <em>unbiased</em> if every observation in a population had an equal chance of being sample.d
<ul>
<li>In our example, did each ball, irrespective of color, have an equal chance of being sampled?</li>
</ul></li>
<li><strong>Random sampling</strong>: We say a sampling procedure is random if we sample randomly from the population in an unbiased fashion.</li>
</ol>
<p><strong>The moral</strong>:</p>
<ul>
<li>If the sampling of a sample of size <span class="math inline">\(n\)</span> is done at random then</li>
<li>The sample is unbiased and representative of the population thus</li>
<li>Any result based on the sample can generalize to the population thus</li>
<li>The point estimate/sample statistic is a “good guess” of the population parameter</li>
</ul>
<p><strong>So in our example</strong>:</p>
<ul>
<li>If we <em>properly mix the balls i.e. stir the bowl</em> first before using the shovel to extract a sample of size <span class="math inline">\(n=50\)</span></li>
<li>The contents of the shovel will “look like” the contents of the bowl thus</li>
<li>Any results based on the <span class="math inline">\(n=50\)</span> balls in the shovel can generalize to the <span class="math inline">\(N=2400\)</span> balls in the bowl thus</li>
<li>The sample proportion <span class="math inline">\(\widehat{p}\)</span> of the <span class="math inline">\(n=50\)</span> balls in the shovel that are red is a “good guess” of the true population proportion <span class="math inline">\(p\)</span> of the <span class="math inline">\(N=2400\)</span> balls that are red.</li>
</ul>
</div>
</div>
<div id="tactile" class="section level2">
<h2><span class="header-section-number">2.2</span> Tactile sampling from bowl</h2>
<div id="tactilely-using-shovel-once" class="section level3">
<h3><span class="header-section-number">2.2.1</span> Tactilely using shovel once</h3>
<p>Let’s now put our sampling shovel into action in the following <em>tactile</em> sampling exercise. Tactile just means physically tangible and perceptible by touch.</p>
<ol style="list-style-type: decimal">
<li>Step 1 in Figure <a href="2-sampling.html#fig:tactile1">2.3</a>: Use the shovel to take a sample of size <span class="math inline">\(n=50\)</span> balls from the bowl</li>
<li>Step 2 in Figure <a href="2-sampling.html#fig:tactile2">2.4</a>: Pour them into a Red Solo Cup and
<ul>
<li>Count the number that are red then</li>
<li>Compute the sample proportion <span class="math inline">\(\widehat{p}\)</span> of the <span class="math inline">\(n=50\)</span> balls that are red.</li>
</ul></li>
<li>Step 3 in Figure <a href="2-sampling.html#fig:tactile3">2.5</a>: Mark the sample proportion <span class="math inline">\(\widehat{p}\)</span> in a hand-drawn histogram.</li>
</ol>
<div class="figure" style="text-align: center"><span id="fig:tactile1"></span>
<img src="images/sampling/tactile_1_b.jpg" alt="Step 1: Take sample of size $n=50$" width="600px" />
<p class="caption">
Figure 2.3: Step 1: Take sample of size <span class="math inline">\(n=50\)</span>
</p>
</div>
<div class="figure" style="text-align: center"><span id="fig:tactile2"></span>
<img src="images/sampling/tactile_2_a.jpg" alt="Step 2: Pour into Red Solo Cup and compute $\widehat{p}$" width="400px" />
<p class="caption">
Figure 2.4: Step 2: Pour into Red Solo Cup and compute <span class="math inline">\(\widehat{p}\)</span>
</p>
</div>
<div class="figure" style="text-align: center"><span id="fig:tactile3"></span>
<img src="images/sampling/tactile_3_a.jpg" alt="Step 3: Mark $\widehat{p}$'s in histogram" width="600px" />
<p class="caption">
Figure 2.5: Step 3: Mark <span class="math inline">\(\widehat{p}\)</span>’s in histogram
</p>
</div>
<p>So for example in Figure <a href="2-sampling.html#fig:tactile1">2.3</a> there are 18 balls out of <span class="math inline">\(n=50\)</span> that are red. The sample proportion red for this particular sample is thus <span class="math inline">\(\widehat{p} = \frac{18}{50} = 0.36\)</span>. Our intrepid students then marked this value in the hand-drawn histogram in Figure <a href="2-sampling.html#fig:tactile3">2.5</a>. After 10 groups of students completed this exercise, the resulting hand-drawn histogram is in Figure <a href="2-sampling.html#fig:tactile4">2.6</a> below. Observe:</p>
<ul>
<li>Five of the sample proportions <span class="math inline">\(\widehat{p}\)</span> (based on five different samples of size <span class="math inline">\(n=50\)</span>) were in the histogram bin <span class="math inline">\([0.30, 0.35)\)</span>. In other words, sample proportions of <span class="math inline">\(\widehat{p} = 0.30\)</span> would be included in this bin, but sample proportions of <span class="math inline">\(\widehat{p} = 0.35\)</span> would be included in the next bin to the right.</li>
<li>The lowest value of <span class="math inline">\(\widehat{p}\)</span> was somewhere between 0.20 and 0.25</li>
<li>The highest value of <span class="math inline">\(\widehat{p}\)</span> was somewhere between 0.45 and 0.50.</li>
</ul>
<div class="figure" style="text-align: center"><span id="fig:tactile4"></span>
<img src="images/sampling/tactile_3_c.jpg" alt="Step 3: Histogram of 10 values of $\widehat{p}$" width="600px" />
<p class="caption">
Figure 2.6: Step 3: Histogram of 10 values of <span class="math inline">\(\widehat{p}\)</span>
</p>
</div>
</div>
<div id="tactilely-using-shovel-33-times" class="section level3">
<h3><span class="header-section-number">2.2.2</span> Tactilely using shovel 33 times</h3>
<p>All told, 33 groups tooks samples: in other words the shovel was used 33 times and 33 values of the sample proportion <span class="math inline">\(\widehat{p}\)</span> were computed. Let’s import this data for all 33 groups and save it in a data frame called <code>tactile_prop_red</code> in Table <a href="2-sampling.html#tab:tactile-prop-red">2.1</a>. Notice how the <code>replicate</code> column enumerates each of the 33 groups, <code>red_balls</code> is the count of balls in the sample of size <span class="math inline">\(n=50\)</span> that we red, and <code>prop_red</code> is the sample proportion <span class="math inline">\(\widehat{p}\)</span> that are red.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(readr)
tactile_prop_red &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;https://rudeboybert.github.io/STAT135/static/sampling_red_balls.csv&quot;</span>)
<span class="kw">View</span>(tactile_prop_red)</code></pre></div>
<table>
<caption><span id="tab:tactile-prop-red">Table 2.1: </span>33 sample proportions based on 33 tactile samples of size n=50</caption>
<thead>
<tr class="header">
<th align="left">group</th>
<th align="right">replicate</th>
<th align="right">red_balls</th>
<th align="right">prop_red</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Ilyas, Yohan</td>
<td align="right">1</td>
<td align="right">21</td>
<td align="right">0.42</td>
</tr>
<tr class="even">
<td align="left">Morgan, Terrance</td>
<td align="right">2</td>
<td align="right">17</td>
<td align="right">0.34</td>
</tr>
<tr class="odd">
<td align="left">Martin, Thomas</td>
<td align="right">3</td>
<td align="right">21</td>
<td align="right">0.42</td>
</tr>
<tr class="even">
<td align="left">Clark, Frank</td>
<td align="right">4</td>
<td align="right">21</td>
<td align="right">0.42</td>
</tr>
<tr class="odd">
<td align="left">Riddhi, Karina</td>
<td align="right">5</td>
<td align="right">18</td>
<td align="right">0.36</td>
</tr>
<tr class="even">
<td align="left">Andrew, Tyler</td>
<td align="right">6</td>
<td align="right">19</td>
<td align="right">0.38</td>
</tr>
<tr class="odd">
<td align="left">Julia</td>
<td align="right">7</td>
<td align="right">19</td>
<td align="right">0.38</td>
</tr>
<tr class="even">
<td align="left">Rachel, Lauren</td>
<td align="right">8</td>
<td align="right">11</td>
<td align="right">0.22</td>
</tr>
<tr class="odd">
<td align="left">Daniel, Caroline</td>
<td align="right">9</td>
<td align="right">15</td>
<td align="right">0.30</td>
</tr>
<tr class="even">
<td align="left">Josh, Maeve</td>
<td align="right">10</td>
<td align="right">17</td>
<td align="right">0.34</td>
</tr>
<tr class="odd">
<td align="left">Emily, Emily</td>
<td align="right">11</td>
<td align="right">16</td>
<td align="right">0.32</td>
</tr>
<tr class="even">
<td align="left">Conrad, Emily</td>
<td align="right">12</td>
<td align="right">18</td>
<td align="right">0.36</td>
</tr>
<tr class="odd">
<td align="left">Oliver, Erik</td>
<td align="right">13</td>
<td align="right">17</td>
<td align="right">0.34</td>
</tr>
<tr class="even">
<td align="left">Isabel, Nam</td>
<td align="right">14</td>
<td align="right">21</td>
<td align="right">0.42</td>
</tr>
<tr class="odd">
<td align="left">Maya, Claire</td>
<td align="right">15</td>
<td align="right">15</td>
<td align="right">0.30</td>
</tr>
<tr class="even">
<td align="left">Cindy, Kimberly</td>
<td align="right">16</td>
<td align="right">20</td>
<td align="right">0.40</td>
</tr>
<tr class="odd">
<td align="left">Kevin, James</td>
<td align="right">17</td>
<td align="right">11</td>
<td align="right">0.22</td>
</tr>
<tr class="even">
<td align="left">Nam, Isabelle</td>
<td align="right">18</td>
<td align="right">21</td>
<td align="right">0.42</td>
</tr>
<tr class="odd">
<td align="left">Harry, Yuko</td>
<td align="right">19</td>
<td align="right">15</td>
<td align="right">0.30</td>
</tr>
<tr class="even">
<td align="left">Yuki, Eileen</td>
<td align="right">20</td>
<td align="right">16</td>
<td align="right">0.32</td>
</tr>
<tr class="odd">
<td align="left">Ramses</td>
<td align="right">21</td>
<td align="right">23</td>
<td align="right">0.46</td>
</tr>
<tr class="even">
<td align="left">Joshua, Elizabeth, Stanley</td>
<td align="right">22</td>
<td align="right">15</td>
<td align="right">0.30</td>
</tr>
<tr class="odd">
<td align="left">Siobhan, Jane</td>
<td align="right">23</td>
<td align="right">18</td>
<td align="right">0.36</td>
</tr>
<tr class="even">
<td align="left">Jack, Will</td>
<td align="right">24</td>
<td align="right">16</td>
<td align="right">0.32</td>
</tr>
<tr class="odd">
<td align="left">Caroline, Katie</td>
<td align="right">25</td>
<td align="right">21</td>
<td align="right">0.42</td>
</tr>
<tr class="even">
<td align="left">Griffin, Nicholas</td>
<td align="right">26</td>
<td align="right">18</td>
<td align="right">0.36</td>
</tr>
<tr class="odd">
<td align="left">Kaitlin, Jordan</td>
<td align="right">27</td>
<td align="right">17</td>
<td align="right">0.34</td>
</tr>
<tr class="even">
<td align="left">Ella, Garrett</td>
<td align="right">28</td>
<td align="right">18</td>
<td align="right">0.36</td>
</tr>
<tr class="odd">
<td align="left">Julie, Hailin</td>
<td align="right">29</td>
<td align="right">15</td>
<td align="right">0.30</td>
</tr>
<tr class="even">
<td align="left">Katie, Caroline</td>
<td align="right">30</td>
<td align="right">21</td>
<td align="right">0.42</td>
</tr>
<tr class="odd">
<td align="left">Mallory, Damani, Melissa</td>
<td align="right">31</td>
<td align="right">21</td>
<td align="right">0.42</td>
</tr>
<tr class="even">
<td align="left">Katie</td>
<td align="right">32</td>
<td align="right">16</td>
<td align="right">0.32</td>
</tr>
<tr class="odd">
<td align="left">Francis, Vignesh</td>
<td align="right">33</td>
<td align="right">19</td>
<td align="right">0.38</td>
</tr>
</tbody>
</table>
</div>
<div id="sampling-distribution" class="section level3">
<h3><span class="header-section-number">2.2.3</span> Sampling distribution</h3>
<p>Using your data visualization skills that you honed in Chapter <a href="#viz"><strong>??</strong></a>, let’s visualize the distribution of these 33 sample proportions red <span class="math inline">\(\widehat{p}\)</span> using a histogram with <code>binwidth = 0.05</code>. This visualization is appropriate since <code>prop_red</code> is a numerical variable.</p>
<pre class="eval"><code>ggplot(tactile_prop_red, aes(x = prop_red)) +
  geom_histogram(binwidth = 0.05, color = &quot;white&quot;) +
  labs(x = &quot;Sample proportion red based on n = 50&quot;, 
       title = &quot;Histogram of 33 sample proportions based on 33 tactile samples of size n=50&quot;) </code></pre>
<div class="figure" style="text-align: center"><span id="fig:samplingdistribution-tactile"></span>
<img src="ismaykim_files/figure-html/samplingdistribution-tactile-1.png" alt="Histogram of 33 sample proportions based on 33 tactile samples of size n=50" width="\textwidth" />
<p class="caption">
Figure 2.7: Histogram of 33 sample proportions based on 33 tactile samples of size n=50
</p>
</div>
<p>Let’s ask ourselves some questions:</p>
<ol style="list-style-type: decimal">
<li>Where is the histogram centered?</li>
<li>What is the spread of this histogram?</li>
</ol>
<p>Recall from Section <a href="#summarize"><strong>??</strong></a> the mean and the standard deviation are two summary statistics that would answer this question:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tactile_prop_red <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarize</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(prop_red), <span class="dt">sd =</span> <span class="kw">sd</span>(prop_red))</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">mean</th>
<th align="right">sd</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.356</td>
<td align="right">0.058</td>
</tr>
</tbody>
</table>
<p>What you have just unpacked are some very deep and very subtle concepts in statistical inference:</p>
<ol style="list-style-type: decimal">
<li>The histogram in Figure <a href="2-sampling.html#fig:samplingdistribution-tactile">2.7</a> is called the <strong>sampling distribution</strong> of <span class="math inline">\(\widehat{p}\)</span> based on samples of size <span class="math inline">\(n=50\)</span>. It describes how values of the sample proportion red will vary from sample to sample due to <strong>sampling variability</strong>. It allows us to identify:
<ul>
<li>Typical/common/plausible values of <span class="math inline">\(\widehat{p}\)</span>. Ex: <span class="math inline">\(\widehat{p} = 0.36\)</span> would be such a value since it would in theory occur frequently.</li>
<li>Atypical/rare/implausible values of <span class="math inline">\(\widehat{p}\)</span>. Ex: <span class="math inline">\(\widehat{p} = 0.8\)</span> would be such a value since it lies far away from most of the distribution.</li>
</ul></li>
<li>If the sampling is done in an unbiased and random fashion, in other words we made sure to stir the bowl before we sampled, then the sampling distribution will be guaranteed to be centered at the true unknown population proportion red <span class="math inline">\(p\)</span>, or in other words the true number of balls out of 2400 that are red.</li>
<li>The spread of this histogram, as quantified by the standard deviation of 0.058, is called the <strong>standard error</strong>. It quantifies the variability of our estimates for <span class="math inline">\(\widehat{p}\)</span>.
<ul>
<li><strong>Note</strong>: A large source of confusion. All standard errors are a form of standard deviation, but not all standard deviations are standard errors.</li>
</ul></li>
</ol>
</div>
</div>
<div id="virtual-sampling-from-bowl" class="section level2">
<h2><span class="header-section-number">2.3</span> Virtual sampling from bowl</h2>
<p>Now let’s mimic the above <em>tactile</em> sampling, but with <em>virtual</em> sampling. In other words:</p>
<ul>
<li>Instead of considering the <em>tactile bowl</em> shown in Figure <a href="2-sampling.html#fig:sampling-exercise-1">2.1</a> above and using a <em>tactile shovel</em> to draw samples of size <span class="math inline">\(n=50\)</span></li>
<li>Let’s use a <em>virtual bowl</em> saved in a computer and use R’s random number generator as a <em>virtual shovel</em> to draw samples of size <span class="math inline">\(n=50\)</span></li>
</ul>
<p>First, we describe our <em>virtual bowl</em>. In the <code>moderndive</code> package, we’ve included a data frame called <code>bowl</code> that has 2400 rows corresponding to the <span class="math inline">\(N=2400\)</span> balls in the physical bowl. Run <code>View(bowl)</code> in RStudio to convince yourselves that <code>bowl</code> is indeed a virtual version of the tactile bowl in the previous section.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bowl</code></pre></div>
<pre><code># A tibble: 2,400 x 2
   ball_ID color
     &lt;int&gt; &lt;chr&gt;
 1       1 white
 2       2 white
 3       3 white
 4       4 red  
 5       5 white
 6       6 white
 7       7 red  
 8       8 white
 9       9 red  
10      10 white
# ... with 2,390 more rows</code></pre>
<p>Note that the balls are not actually marked with numbers; the variable <code>ball_ID</code> is merely used as an identification variable for each row of <code>bowl</code>. Recall our previous discussion on identification variables in Subsection <a href="#identification-vs-measurement"><strong>??</strong></a> in the “Data Tidying” Chapter <a href="#tidy"><strong>??</strong></a>.</p>
<p>Next, we describe our <em>virtual shovel</em>: the <code>rep_sample_n()</code> function included in the <code>moderndive</code> package where <code>rep_sample_n()</code> indicates that we are taking repeated/replicated samples of size <span class="math inline">\(n\)</span>.</p>
<div id="virtually-using-shovel-once" class="section level3">
<h3><span class="header-section-number">2.3.1</span> Virtually using shovel once</h3>
<p>The <code>rep_sample_n()</code> function included in the <code>moderndive</code> package where <code>rep_sample_n()</code> indicates that we are taking repeated/replicated samples of size <span class="math inline">\(n\)</span>. Let’s perform the virtual analogue of tactilely inserting the shovel <em>only once</em> into the bowl and extracting a sample of <code>size</code> <span class="math inline">\(n=50\)</span>. In the table below we only show results about the first 10 sampled balls out of 50.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">virtual_shovel &lt;-<span class="st"> </span>bowl <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">rep_sample_n</span>(<span class="dt">size =</span> <span class="dv">50</span>)
<span class="kw">View</span>(virtual_shovel)</code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-9">Table 2.2: </span>First 10 sampled balls of 50 in virtual sample</caption>
<thead>
<tr class="header">
<th align="right">replicate</th>
<th align="right">ball_ID</th>
<th align="right">color</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">2079</td>
<td align="right">red</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">1076</td>
<td align="right">white</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">1691</td>
<td align="right">red</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">1687</td>
<td align="right">red</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">1434</td>
<td align="right">white</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">954</td>
<td align="right">white</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">483</td>
<td align="right">white</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">1520</td>
<td align="right">white</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">2060</td>
<td align="right">red</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">1682</td>
<td align="right">white</td>
</tr>
</tbody>
</table>
<p>Looking at all 50 rows of <code>virtual_shovel</code> in the spreadsheet viewer that pops up after running <code>View(virtual_shovel)</code>, the <code>ball_ID</code> variable seems to suggest that we do indeed have a random sample of <span class="math inline">\(n=50\)</span> balls. However, what does the <code>replicate</code> variable indidate, where in this case it’s equal to 1 for all 50 rows? We’ll see in a minute. First let’s compute the both the number of balls red and the proportion red out of <span class="math inline">\(n=50\)</span> using our <code>dplyr</code> data wrangling tools from Chapter <a href="#wrangling"><strong>??</strong></a>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">virtual_shovel <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarize</span>(<span class="dt">red =</span> <span class="kw">sum</span>(color <span class="op">==</span><span class="st"> &quot;red&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">prop_red =</span> red <span class="op">/</span><span class="st"> </span><span class="dv">50</span>)</code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-11">Table 2.3: </span>Count and proportion red in single virtual sample of size n = 50</caption>
<thead>
<tr class="header">
<th align="right">replicate</th>
<th align="right">red</th>
<th align="right">prop_red</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">23</td>
<td align="right">0.46</td>
</tr>
</tbody>
</table>
<p>Why does this work? Because for every row where <code>color == &quot;red&quot;</code>, the boolean <code>TRUE</code> is returned and R treats <code>TRUE</code> like the number <code>1</code>. Equivalently, for every row where <code>color</code> is not equal to <code>&quot;red&quot;</code>, the boolean <code>FALSE</code> is returned and R treats <code>FALSE</code> like the number <code>0</code>. So summing the number of <code>TRUE</code>’s and <code>FALSE</code>’s is equivalent to summing <code>1</code>’s and <code>0</code>’s which counts the number of balls where <code>color</code> is <code>red</code>.</p>
</div>
<div id="virtually-using-shovel-33-times" class="section level3">
<h3><span class="header-section-number">2.3.2</span> Virtually using shovel 33 times</h3>
<p>Recall however in our tactile sampling exercise in Section <a href="2-sampling.html#tactile">2.2</a> above that we had 33 groups of students take 33 samples of size <span class="math inline">\(n=50\)</span> using the shovel 33 times and hence compute 33 separate values of the sample proportion red <span class="math inline">\(\widehat{p}\)</span>. In other words we <em>repeated/replicated</em> the sampling 33 times. We can achieve this by reusing the same <code>rep_sample_n()</code> function code above, but by adding the <code>reps = 33</code> argument indicating we want to repeat this sampling 33 times:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">virtual_samples &lt;-<span class="st"> </span>bowl <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">rep_sample_n</span>(<span class="dt">size =</span> <span class="dv">50</span>, <span class="dt">reps =</span> <span class="dv">33</span>)
<span class="kw">View</span>(virtual_samples)</code></pre></div>
<p><code>virtual_samples</code> has <span class="math inline">\(50 \times 33 = 1650\)</span> rows, corresponding to 33 samples of size <span class="math inline">\(n=50\)</span>, or 33 draws from the shovel. We won’t display the contents of this data frame but leave it to you to <code>View()</code> this data frame. You’ll see that the first 50 rows have <code>replicate</code> equal to 1, then the next 50 rows have <code>replicate</code> equal to 2, and so on and so forth, up until the last 50 rows which have <code>replicate</code> equal to 33. The <code>replicate</code> variable denotes which of our 33 samples a particular ball is included in.</p>
<p>Now let’s compute the 33 corresponding values of the sample proportion <span class="math inline">\(\widehat{p}\)</span> based on 33 different samples of size <span class="math inline">\(n=50\)</span> by reusing the previous code, but remembering to <code>group_by</code> the <code>replicate</code> variable first since we want to compute the sample proportion for each of the 33 samples separately. Notice the similarity of this table with Table <a href="2-sampling.html#tab:tactile-prop-red">2.1</a>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">virtual_prop_red &lt;-<span class="st"> </span>virtual_samples <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(replicate) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarize</span>(<span class="dt">red =</span> <span class="kw">sum</span>(color <span class="op">==</span><span class="st"> &quot;red&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">prop_red =</span> red <span class="op">/</span><span class="st"> </span><span class="dv">50</span>)
<span class="kw">View</span>(virtual_prop_red)</code></pre></div>
<table>
<caption><span id="tab:virtual-prop-red">Table 2.4: </span>33 sample proportions red based on 33 virtual samples of size n=50</caption>
<thead>
<tr class="header">
<th align="right">replicate</th>
<th align="right">red</th>
<th align="right">prop_red</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">17</td>
<td align="right">0.34</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">20</td>
<td align="right">0.40</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">24</td>
<td align="right">0.48</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">20</td>
<td align="right">0.40</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">17</td>
<td align="right">0.34</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="right">16</td>
<td align="right">0.32</td>
</tr>
<tr class="odd">
<td align="right">7</td>
<td align="right">17</td>
<td align="right">0.34</td>
</tr>
<tr class="even">
<td align="right">8</td>
<td align="right">19</td>
<td align="right">0.38</td>
</tr>
<tr class="odd">
<td align="right">9</td>
<td align="right">19</td>
<td align="right">0.38</td>
</tr>
<tr class="even">
<td align="right">10</td>
<td align="right">12</td>
<td align="right">0.24</td>
</tr>
<tr class="odd">
<td align="right">11</td>
<td align="right">22</td>
<td align="right">0.44</td>
</tr>
<tr class="even">
<td align="right">12</td>
<td align="right">17</td>
<td align="right">0.34</td>
</tr>
<tr class="odd">
<td align="right">13</td>
<td align="right">20</td>
<td align="right">0.40</td>
</tr>
<tr class="even">
<td align="right">14</td>
<td align="right">22</td>
<td align="right">0.44</td>
</tr>
<tr class="odd">
<td align="right">15</td>
<td align="right">13</td>
<td align="right">0.26</td>
</tr>
<tr class="even">
<td align="right">16</td>
<td align="right">15</td>
<td align="right">0.30</td>
</tr>
<tr class="odd">
<td align="right">17</td>
<td align="right">23</td>
<td align="right">0.46</td>
</tr>
<tr class="even">
<td align="right">18</td>
<td align="right">20</td>
<td align="right">0.40</td>
</tr>
<tr class="odd">
<td align="right">19</td>
<td align="right">16</td>
<td align="right">0.32</td>
</tr>
<tr class="even">
<td align="right">20</td>
<td align="right">12</td>
<td align="right">0.24</td>
</tr>
<tr class="odd">
<td align="right">21</td>
<td align="right">14</td>
<td align="right">0.28</td>
</tr>
<tr class="even">
<td align="right">22</td>
<td align="right">21</td>
<td align="right">0.42</td>
</tr>
<tr class="odd">
<td align="right">23</td>
<td align="right">14</td>
<td align="right">0.28</td>
</tr>
<tr class="even">
<td align="right">24</td>
<td align="right">18</td>
<td align="right">0.36</td>
</tr>
<tr class="odd">
<td align="right">25</td>
<td align="right">19</td>
<td align="right">0.38</td>
</tr>
<tr class="even">
<td align="right">26</td>
<td align="right">12</td>
<td align="right">0.24</td>
</tr>
<tr class="odd">
<td align="right">27</td>
<td align="right">22</td>
<td align="right">0.44</td>
</tr>
<tr class="even">
<td align="right">28</td>
<td align="right">23</td>
<td align="right">0.46</td>
</tr>
<tr class="odd">
<td align="right">29</td>
<td align="right">19</td>
<td align="right">0.38</td>
</tr>
<tr class="even">
<td align="right">30</td>
<td align="right">18</td>
<td align="right">0.36</td>
</tr>
<tr class="odd">
<td align="right">31</td>
<td align="right">20</td>
<td align="right">0.40</td>
</tr>
<tr class="even">
<td align="right">32</td>
<td align="right">17</td>
<td align="right">0.34</td>
</tr>
<tr class="odd">
<td align="right">33</td>
<td align="right">20</td>
<td align="right">0.40</td>
</tr>
</tbody>
</table>
<p>Just as we did before, let’s draw a histogram with <code>binwidth = 0.05</code> of the 33 sample proportions <span class="math inline">\(\widehat{p}\)</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(virtual_prop_red, <span class="kw">aes</span>(<span class="dt">x =</span> prop_red)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="fl">0.05</span>, <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Sample proportion red based on n = 50&quot;</span>, 
       <span class="dt">title =</span> <span class="st">&quot;Histogram of 33 sample proportions based on 33 virtual samples of size n=50&quot;</span>) </code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:samplingdistribution-virtual"></span>
<img src="ismaykim_files/figure-html/samplingdistribution-virtual-1.png" alt="Histogram of 33 sample proportions red based on 33 virtual samples of size n=50" width="\textwidth" />
<p class="caption">
Figure 2.8: Histogram of 33 sample proportions red based on 33 virtual samples of size n=50
</p>
</div>
<p>Let’s now compare the:</p>
<ul>
<li>Tactile sampling-based sampling distribution from the previous section to the</li>
<li>Virtual sampling-based sampling distribution from this section</li>
</ul>
<p><img src="ismaykim_files/figure-html/unnamed-chunk-16-1.png" width="\textwidth" style="display: block; margin: auto;" /></p>
<p>We see that they are similar and center and spread, although not identical due to random variation.</p>
</div>
<div id="virtually-using-shovel-1000-times" class="section level3">
<h3><span class="header-section-number">2.3.3</span> Virtually using shovel 1000 times</h3>
<p>In Figure <a href="2-sampling.html#fig:samplingdistribution-virtual">2.8</a>, we can start seeing a pattern in the sampling distribution emerge. However, 33 values of the sample proportion <span class="math inline">\(\widehat{p}\)</span> might not be enough to get a true sense of the distribution. Using 1000 values of <span class="math inline">\(\widehat{p}\)</span> would definitely give a better sense. What are our two options for constructing the these histograms?</p>
<ol style="list-style-type: decimal">
<li>Tactile sampling: Make the 33 groups of students take <span class="math inline">\(\frac{1000}{33} \approx 31\)</span> samples of size <span class="math inline">\(n=50\)</span> each, count the number of red balls for each of the 1000 tactile samples, and then compute the 1000 corresponding values of the sample proportion <span class="math inline">\(\widehat{p}\)</span>. However, this would be cruel and unusual as this would take hours!</li>
<li>Virtual sampling: Computers are very good at automating repetitive tasks such as this one. This is the way to go!</li>
</ol>
<p>First, generate 1000 samples of size <span class="math inline">\(n=50\)</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">virtual_samples &lt;-<span class="st"> </span>bowl <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">rep_sample_n</span>(<span class="dt">size =</span> <span class="dv">50</span>, <span class="dt">reps =</span> <span class="dv">1000</span>)
<span class="kw">View</span>(virtual_samples)</code></pre></div>
<p>Then for each of these 1000 samples of size <span class="math inline">\(n=50\)</span>, compute the corresponding sample proportions</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">virtual_prop_red &lt;-<span class="st"> </span>virtual_samples <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(replicate) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarize</span>(<span class="dt">red =</span> <span class="kw">sum</span>(color <span class="op">==</span><span class="st"> &quot;red&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">prop_red =</span> red <span class="op">/</span><span class="st"> </span><span class="dv">50</span>)
<span class="kw">View</span>(virtual_prop_red)</code></pre></div>
<p>Finally plot it</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(virtual_prop_red, <span class="kw">aes</span>(<span class="dt">x =</span> prop_red)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="fl">0.05</span>, <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Sample proportion red based on n = 50&quot;</span>, <span class="dt">title =</span> <span class="st">&quot;Histogram of 1000 sample proportions based on 1000 virtual samples of size n=50&quot;</span>) </code></pre></div>
<p><img src="ismaykim_files/figure-html/unnamed-chunk-22-1.png" width="\textwidth" style="display: block; margin: auto;" /></p>
<div class="learncheck">
<p>
<strong><em>Learning check</em></strong>
</p>
</div>
<p><strong>(LC8.1)</strong> What is the standard error of the above sampling distribution of <span class="math inline">\(\widehat{p}\)</span> based on 1000 samples of size <span class="math inline">\(n=50\)</span>? Recall you are <em>virtually</em> micking the act of sampling with the following <em>tactile</em> shovel with <span class="math inline">\(n=50\)</span> slots:</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-24"></span>
<img src="images/sampling/shovel_050.jpg" alt="Tactile shovel for sampling n = 50 balls" width="400px" />
<p class="caption">
Figure 2.9: Tactile shovel for sampling n = 50 balls
</p>
</div>
<p><strong>(LC8.2)</strong> Change the sample size to <span class="math inline">\(n=25\)</span>? What difference do you notice about the sampling distribution and the standard error? This corresponds to <em>virtually</em> micking the act of sampling with the following <em>tactile</em> shovel with <span class="math inline">\(n=25\)</span> slots:</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-25"></span>
<img src="images/sampling/shovel_025.jpg" alt="Tactile shovel for sampling n = 25 balls" width="400px" />
<p class="caption">
Figure 2.10: Tactile shovel for sampling n = 25 balls
</p>
</div>
<p><strong>(LC8.3)</strong> Change the sample size to <span class="math inline">\(n=100\)</span>? What difference do you notice about the sampling distribution and the standard error? This corresponds to <em>virtually</em> micking the act of sampling with the following <em>tactile</em> shovel with <span class="math inline">\(n=100\)</span> slots, which would take forever to actually do tactilely!</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-26"></span>
<img src="images/sampling/shovel_100.jpg" alt="Tactile shovel for sampling n = 100 balls" width="400px" />
<p class="caption">
Figure 2.11: Tactile shovel for sampling n = 100 balls
</p>
</div>
<div class="learncheck">

</div>
</div>
<div id="comparing-sampling-distributions" class="section level3">
<h3><span class="header-section-number">2.3.4</span> Comparing sampling distributions</h3>
<p>Based on the learning checks above, let’s now compare the sampling distribution of the sample proportion <span class="math inline">\(\widehat{p}\)</span> based on 1000 virtual samples of size <span class="math inline">\(n=25\)</span>, <span class="math inline">\(n=50\)</span>, <span class="math inline">\(n=100\)</span></p>
<p><strong>(LC8.1)</strong>: Shovel with <span class="math inline">\(n=50\)</span> slots</p>
<p>First, take 1000 virtual samples of size <span class="math inline">\(n=50\)</span>, mimicking the act of taking 1000 tactile samples using the shovel with <span class="math inline">\(n=50\)</span> slots:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">virtual_samples_<span class="dv">50</span> &lt;-<span class="st"> </span>bowl <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">rep_sample_n</span>(<span class="dt">size =</span> <span class="dv">50</span>, <span class="dt">reps =</span> <span class="dv">1000</span>)</code></pre></div>
<p>Then based on each of these 1000 virtual samples of size <span class="math inline">\(n=50\)</span>, compute the corresponding 1000 sample proportions <span class="math inline">\(\widehat{p}\)</span> being sure to divide by <code>50</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">virtual_prop_red_<span class="dv">50</span> &lt;-<span class="st"> </span>virtual_samples_<span class="dv">50</span> <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(replicate) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarize</span>(<span class="dt">red =</span> <span class="kw">sum</span>(color <span class="op">==</span><span class="st"> &quot;red&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">prop_red =</span> red <span class="op">/</span><span class="st"> </span><span class="dv">50</span>)</code></pre></div>
<p>The <em>standard error</em> is the standard deviation of the 1000 sample proportions <span class="math inline">\(\widehat{p}\)</span>, in other words we are quantifying how much <span class="math inline">\(\widehat{p}\)</span> varies from sample-to-sample based on samples of size <span class="math inline">\(n=50\)</span> due to sampling variation.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">virtual_prop_red_<span class="dv">50</span> <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarize</span>(<span class="dt">SE =</span> <span class="kw">sd</span>(prop_red))</code></pre></div>
<pre><code># A tibble: 1 x 1
      SE
   &lt;dbl&gt;
1 0.0694</code></pre>
<p><strong>(LC8.2)</strong>: Shovel with <span class="math inline">\(n=25\)</span> slots</p>
<p>First, take 1000 virtual samples of size <span class="math inline">\(n=25\)</span>, mimicking the act of taking 1000 tactile samples using the shovel with <span class="math inline">\(n=25\)</span> slots:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">virtual_samples_<span class="dv">25</span> &lt;-<span class="st"> </span>bowl <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">rep_sample_n</span>(<span class="dt">size =</span> <span class="dv">25</span>, <span class="dt">reps =</span> <span class="dv">1000</span>)</code></pre></div>
<p>Then based on each of these 1000 virtual samples of size <span class="math inline">\(n=50\)</span>, compute the corresponding 1000 sample proportions <span class="math inline">\(\widehat{p}\)</span> being sure to divide by <code>50</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">virtual_prop_red_<span class="dv">25</span> &lt;-<span class="st"> </span>virtual_samples_<span class="dv">25</span> <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(replicate) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarize</span>(<span class="dt">red =</span> <span class="kw">sum</span>(color <span class="op">==</span><span class="st"> &quot;red&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">prop_red =</span> red <span class="op">/</span><span class="st"> </span><span class="dv">25</span>)</code></pre></div>
<p>The <em>standard error</em> is the standard deviation of the 1000 sample proportions <span class="math inline">\(\widehat{p}\)</span>, in other words we are quantifying how much <span class="math inline">\(\widehat{p}\)</span> varies from sample-to-sample based on samples of size <span class="math inline">\(n=25\)</span> due to sampling variation.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">virtual_prop_red_<span class="dv">25</span> <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarize</span>(<span class="dt">SE =</span> <span class="kw">sd</span>(prop_red))</code></pre></div>
<pre><code># A tibble: 1 x 1
     SE
  &lt;dbl&gt;
1 0.100</code></pre>
<p><strong>(LC8.3)</strong>: Shovel with <span class="math inline">\(n=100\)</span> slots</p>
<p>First, take 1000 virtual samples of size <span class="math inline">\(n=100\)</span>, mimicking the act of taking 1000 tactile samples using the shovel with <span class="math inline">\(n=100\)</span> slots:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">virtual_samples_<span class="dv">100</span> &lt;-<span class="st"> </span>bowl <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">rep_sample_n</span>(<span class="dt">size =</span> <span class="dv">100</span>, <span class="dt">reps =</span> <span class="dv">1000</span>)</code></pre></div>
<p>Then based on each of these 1000 virtual samples of size <span class="math inline">\(n=100\)</span>, compute the corresponding 1000 sample proportions <span class="math inline">\(\widehat{p}\)</span> being sure to divide by <code>100</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">virtual_prop_red_<span class="dv">100</span> &lt;-<span class="st"> </span>virtual_samples_<span class="dv">100</span> <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(replicate) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarize</span>(<span class="dt">red =</span> <span class="kw">sum</span>(color <span class="op">==</span><span class="st"> &quot;red&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">prop_red =</span> red <span class="op">/</span><span class="st"> </span><span class="dv">100</span>)</code></pre></div>
<p>The <em>standard error</em> is the standard deviation of the 1000 sample proportions <span class="math inline">\(\widehat{p}\)</span>, in other words we are quantifying how much <span class="math inline">\(\widehat{p}\)</span> varies from sample-to-sample based on samples of size <span class="math inline">\(n=100\)</span> due to sampling variation.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">virtual_prop_red_<span class="dv">100</span> <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarize</span>(<span class="dt">SE =</span> <span class="kw">sd</span>(prop_red))</code></pre></div>
<pre><code># A tibble: 1 x 1
      SE
   &lt;dbl&gt;
1 0.0457</code></pre>
<p><strong>Put it together</strong></p>
<p>Let’s compare the 3 standard errors…</p>
<table>
<caption><span id="tab:comparing-n">Table 2.5: </span>Comparing the SE for different n</caption>
<thead>
<tr class="header">
<th align="right">n</th>
<th align="right">SE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">25</td>
<td align="right">0.10</td>
</tr>
<tr class="even">
<td align="right">50</td>
<td align="right">0.07</td>
</tr>
<tr class="odd">
<td align="right">100</td>
<td align="right">0.05</td>
</tr>
</tbody>
</table>
<p>which are a numerical quantification of the spreads of the following three histograms of the sampling distribution of the sample proportion <span class="math inline">\(\widehat{p}\)</span>:</p>
<div class="figure" style="text-align: center"><span id="fig:comparing-sampling-distributions"></span>
<img src="ismaykim_files/figure-html/comparing-sampling-distributions-1.png" alt="Comparing sampling distributions of p-hat for different sample sizes n" width="\textwidth" />
<p class="caption">
Figure 2.12: Comparing sampling distributions of p-hat for different sample sizes n
</p>
</div>
<div class="learncheck">

</div>
</div>
</div>
<div id="central-limit-theorem" class="section level2">
<h2><span class="header-section-number">2.4</span> Central Limit Theorem</h2>
<p>What you have just shown in the previous section is a very famous theorem, or mathematically proven truth, called the <em>Central Limit Theorem</em>. It loosely states that when samples means and sample proportions are based on larger and larger samples, the sampling distribution corresponding to these point estimates get</p>
<ol style="list-style-type: decimal">
<li>More and more normal</li>
<li>More and more narrow</li>
</ol>
<p>Shuyi Chiou, Casey Dunn, and Pathikrit Bhattacharyya created the following 3m38s video explaining this crucial theorem to statistics using as examples, what else?</p>
<ol style="list-style-type: decimal">
<li>The average weight of wild bunny rabbits!</li>
<li>The average wing span of dragons!</li>
</ol>
<center>
<iframe width="800" height="450" src="https://www.youtube.com/embed/jvoxEYmQHNM" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen>
</iframe>
</center>
</div>
<div id="conclusion" class="section level2">
<h2><span class="header-section-number">2.5</span> Conclusion</h2>
<div id="whats-to-come" class="section level3">
<h3><span class="header-section-number">2.5.1</span> What’s to come?</h3>
<p>This chapter serves as an introduction to the theoretical underpinning of the statistical inference techniques that will be discussed in greater detail in Chapter <a href="#ci"><strong>??</strong></a> for confidence intervals and Chapter <a href="#hypo"><strong>??</strong></a> for hypothesis testing.</p>
</div>
<div id="script-of-r-code" class="section level3">
<h3><span class="header-section-number">2.5.2</span> Script of R code</h3>
<p>An R script file of all R code used in this chapter is available <a href="https://moderndive.netlify.com/scripts/08-sampling.R">here</a>.</p>

<div id="refs" class="references">
<div>
<p>Chihara, Laura M., and Tim C. Hesterberg. 2011. <em>Mathematical Statistics with Resampling and R</em>. Hoboken, NJ: John Wiley; Sons. <a href="https://sites.google.com/site/chiharahesterberg/home" class="uri">https://sites.google.com/site/chiharahesterberg/home</a>.</p>
</div>
<div>
<p>Diez, David M, Christopher D Barr, and Mine Çetinkaya-Rundel. 2014. <em>Introductory Statistics with Randomization and Simulation</em>. First Edition. <a href="https://www.openintro.org/stat/textbook.php?stat_book=isrs" class="uri">https://www.openintro.org/stat/textbook.php?stat_book=isrs</a>.</p>
</div>
<div>
<p>Grolemund, Garrett, and Hadley Wickham. 2016. <em>R for Data Science</em>. <a href="http://r4ds.had.co.nz/" class="uri">http://r4ds.had.co.nz/</a>.</p>
</div>
<div>
<p>Xie, Yihui. 2018. <em>Bookdown: Authoring Books and Technical Documents with R Markdown</em>. <a href="https://CRAN.R-project.org/package=bookdown" class="uri">https://CRAN.R-project.org/package=bookdown</a>.</p>
</div>
</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/moderndive/moderndive_book/edit/master/08-sampling.Rmd",
"text": "Edit"
},
"download": null,
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
