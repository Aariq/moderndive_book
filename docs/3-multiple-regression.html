<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>An Introduction to Statistical and Data Sciences via R</title>
  <meta name="description" content="An open-source and fully-reproducible electronic textbook bridging the gap between traditional introductory statistics and data science courses.">
  <meta name="generator" content="bookdown 0.5 and GitBook 2.6.7">

  <meta property="og:title" content="An Introduction to Statistical and Data Sciences via R" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="http://moderndive.com/" />
  <meta property="og:image" content="http://moderndive.com/images/logos/book_cover.png" />
  <meta property="og:description" content="An open-source and fully-reproducible electronic textbook bridging the gap between traditional introductory statistics and data science courses." />
  <meta name="github-repo" content="moderndive/moderndive_book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="An Introduction to Statistical and Data Sciences via R" />
  
  <meta name="twitter:description" content="An open-source and fully-reproducible electronic textbook bridging the gap between traditional introductory statistics and data science courses." />
  <meta name="twitter:image" content="http://moderndive.com/images/logos/book_cover.png" />

<meta name="author" content="Chester Ismay and Albert Y. Kim">


<meta name="date" content="2018-01-25">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <link rel="apple-touch-icon-precomposed" sizes="152x152" href="images/logos/favicons/apple-touch-icon.png">
  <link rel="shortcut icon" href="images/logos/favicons/favicon.ico" type="image/x-icon">
<link rel="prev" href="2-regression.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-89938436-1', 'auto');
  ga('send', 'pageview');

</script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#sec:intro-for-students"><i class="fa fa-check"></i><b>1.1</b> Introduction for students</a><ul>
<li class="chapter" data-level="1.1.1" data-path="index.html"><a href="index.html#subsec:learning-goals"><i class="fa fa-check"></i><b>1.1.1</b> What you will learn from this book</a></li>
<li class="chapter" data-level="1.1.2" data-path="index.html"><a href="index.html#subsec:pipeline"><i class="fa fa-check"></i><b>1.1.2</b> Data/science pipeline</a></li>
<li class="chapter" data-level="1.1.3" data-path="index.html"><a href="index.html#subsec:reproducible"><i class="fa fa-check"></i><b>1.1.3</b> Reproducible research</a></li>
<li class="chapter" data-level="1.1.4" data-path="index.html"><a href="index.html#final-note-for-students"><i class="fa fa-check"></i><b>1.1.4</b> Final note for students</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#sec:intro-instructors"><i class="fa fa-check"></i><b>1.2</b> Introduction for instructors</a><ul>
<li class="chapter" data-level="1.2.1" data-path="index.html"><a href="index.html#who-is-this-book-for"><i class="fa fa-check"></i><b>1.2.1</b> Who is this book for?</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#sec:connect-contribute"><i class="fa fa-check"></i><b>1.3</b> Connect and contribute</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#sec:about-book"><i class="fa fa-check"></i><b>1.4</b> About this book</a></li>
</ul></li>
<li class="part"><span><b>I Data Modeling via moderndive</b></span></li>
<li class="chapter" data-level="2" data-path="2-regression.html"><a href="2-regression.html"><i class="fa fa-check"></i><b>2</b> Basic Regression</a><ul>
<li class="chapter" data-level="" data-path="2-regression.html"><a href="2-regression.html#needed-packages"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="2.1" data-path="2-regression.html"><a href="2-regression.html#model1"><i class="fa fa-check"></i><b>2.1</b> One numerical x</a><ul>
<li class="chapter" data-level="2.1.1" data-path="2-regression.html"><a href="2-regression.html#model1EDA"><i class="fa fa-check"></i><b>2.1.1</b> Exploratory data analysis</a></li>
<li class="chapter" data-level="2.1.2" data-path="2-regression.html"><a href="2-regression.html#model1table"><i class="fa fa-check"></i><b>2.1.2</b> Simple linear regression</a></li>
<li class="chapter" data-level="2.1.3" data-path="2-regression.html"><a href="2-regression.html#model1points"><i class="fa fa-check"></i><b>2.1.3</b> Observed/fitted values and residuals</a></li>
<li class="chapter" data-level="2.1.4" data-path="2-regression.html"><a href="2-regression.html#model1residuals"><i class="fa fa-check"></i><b>2.1.4</b> Residual analysis</a></li>
<li class="chapter" data-level="2.1.5" data-path="2-regression.html"><a href="2-regression.html#your-turn"><i class="fa fa-check"></i><b>2.1.5</b> Your Turn</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="2-regression.html"><a href="2-regression.html#model2"><i class="fa fa-check"></i><b>2.2</b> One categorical x</a><ul>
<li class="chapter" data-level="2.2.1" data-path="2-regression.html"><a href="2-regression.html#model2EDA"><i class="fa fa-check"></i><b>2.2.1</b> Exploratory data analysis</a></li>
<li class="chapter" data-level="2.2.2" data-path="2-regression.html"><a href="2-regression.html#model2table"><i class="fa fa-check"></i><b>2.2.2</b> Linear regression</a></li>
<li class="chapter" data-level="2.2.3" data-path="2-regression.html"><a href="2-regression.html#model2points"><i class="fa fa-check"></i><b>2.2.3</b> Observed/fitted values and residuals</a></li>
<li class="chapter" data-level="2.2.4" data-path="2-regression.html"><a href="2-regression.html#model2residuals"><i class="fa fa-check"></i><b>2.2.4</b> Residual analysis</a></li>
<li class="chapter" data-level="2.2.5" data-path="2-regression.html"><a href="2-regression.html#your-turn-1"><i class="fa fa-check"></i><b>2.2.5</b> Your turn</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="2-regression.html"><a href="2-regression.html#other-topics"><i class="fa fa-check"></i><b>2.3</b> Other topics</a><ul>
<li class="chapter" data-level="2.3.1" data-path="2-regression.html"><a href="2-regression.html#correlationcoefficient"><i class="fa fa-check"></i><b>2.3.1</b> Correlation coefficient</a></li>
<li class="chapter" data-level="2.3.2" data-path="2-regression.html"><a href="2-regression.html#correlation-is-not-causation"><i class="fa fa-check"></i><b>2.3.2</b> Correlation is not necessarily causation</a></li>
<li class="chapter" data-level="2.3.3" data-path="2-regression.html"><a href="2-regression.html#leastsquares"><i class="fa fa-check"></i><b>2.3.3</b> Best fitting line</a></li>
<li class="chapter" data-level="2.3.4" data-path="2-regression.html"><a href="2-regression.html#underthehood"><i class="fa fa-check"></i><b>2.3.4</b> How does <code>get_regression_table()</code> work?</a></li>
<li class="chapter" data-level="2.3.5" data-path="2-regression.html"><a href="2-regression.html#script-of-r-code"><i class="fa fa-check"></i><b>2.3.5</b> Script of R code</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="3-multiple-regression.html"><a href="3-multiple-regression.html"><i class="fa fa-check"></i><b>3</b> Multiple Regression</a><ul>
<li class="chapter" data-level="" data-path="3-multiple-regression.html"><a href="3-multiple-regression.html#needed-packages-1"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="3.1" data-path="3-multiple-regression.html"><a href="3-multiple-regression.html#model3"><i class="fa fa-check"></i><b>3.1</b> Two numerical x</a><ul>
<li class="chapter" data-level="3.1.1" data-path="3-multiple-regression.html"><a href="3-multiple-regression.html#model3EDA"><i class="fa fa-check"></i><b>3.1.1</b> Exploratory data analysis</a></li>
<li class="chapter" data-level="3.1.2" data-path="3-multiple-regression.html"><a href="3-multiple-regression.html#model3table"><i class="fa fa-check"></i><b>3.1.2</b> Multiple regression</a></li>
<li class="chapter" data-level="3.1.3" data-path="3-multiple-regression.html"><a href="3-multiple-regression.html#model3points"><i class="fa fa-check"></i><b>3.1.3</b> Observed/fitted values and residuals</a></li>
<li class="chapter" data-level="3.1.4" data-path="3-multiple-regression.html"><a href="3-multiple-regression.html#model3residuals"><i class="fa fa-check"></i><b>3.1.4</b> Residual analysis</a></li>
<li class="chapter" data-level="3.1.5" data-path="3-multiple-regression.html"><a href="3-multiple-regression.html#your-turn-2"><i class="fa fa-check"></i><b>3.1.5</b> Your turn</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="3-multiple-regression.html"><a href="3-multiple-regression.html#model4"><i class="fa fa-check"></i><b>3.2</b> One numerical &amp; one categorical x</a><ul>
<li class="chapter" data-level="3.2.1" data-path="3-multiple-regression.html"><a href="3-multiple-regression.html#model4EDA"><i class="fa fa-check"></i><b>3.2.1</b> Exploratory data analysis</a></li>
<li class="chapter" data-level="3.2.2" data-path="3-multiple-regression.html"><a href="3-multiple-regression.html#model4table"><i class="fa fa-check"></i><b>3.2.2</b> Multiple regression</a></li>
<li class="chapter" data-level="3.2.3" data-path="3-multiple-regression.html"><a href="3-multiple-regression.html#mutiple-regression-with-interaction-effects"><i class="fa fa-check"></i><b>3.2.3</b> Mutiple regression with interaction effects</a></li>
<li class="chapter" data-level="3.2.4" data-path="3-multiple-regression.html"><a href="3-multiple-regression.html#model4points"><i class="fa fa-check"></i><b>3.2.4</b> Observed/fitted values and residuals</a></li>
<li class="chapter" data-level="3.2.5" data-path="3-multiple-regression.html"><a href="3-multiple-regression.html#model4residuals"><i class="fa fa-check"></i><b>3.2.5</b> Residual analysis</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="3-multiple-regression.html"><a href="3-multiple-regression.html#other-topics-1"><i class="fa fa-check"></i><b>3.3</b> Other topics</a><ul>
<li class="chapter" data-level="3.3.1" data-path="3-multiple-regression.html"><a href="3-multiple-regression.html#simpsonsparadox"><i class="fa fa-check"></i><b>3.3.1</b> Simpson’s Paradox</a></li>
<li class="chapter" data-level="3.3.2" data-path="3-multiple-regression.html"><a href="3-multiple-regression.html#script-of-r-code-1"><i class="fa fa-check"></i><b>3.3.2</b> Script of R code</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">An Introduction to Statistical and Data Sciences via R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<html>
<img src='http://moderndive.com/images/logos/wide_format.png' alt="ModernDive">
</html>
<div id="multiple-regression" class="section level1">
<h1><span class="header-section-number">3</span> Multiple Regression</h1>
<p>Now that we are equipped with data visualization skills from Chapter <a href="#viz"><strong>??</strong></a>, data wrangling skills from Chapter <a href="#wrangling"><strong>??</strong></a>, and an understanding of the “tidy” data format from Chapter <a href="#tidy"><strong>??</strong></a>, we now proceed with data modeling. The fundamental premise of data modeling is <em>to model the relationship</em> between:</p>
<ul>
<li>An outcome variable <span class="math inline">\(y\)</span>, also called a dependent variable and</li>
<li>An explanatory/predictor variable <span class="math inline">\(x\)</span>, also called an independent variable or covariate.</li>
</ul>
<p>Another way to state this is using mathematical terminology: we will model the outcome variable <span class="math inline">\(y\)</span> <em>as a function</em> of the explanatory/predictor variable <span class="math inline">\(x\)</span>. Why do we have two different labels, explanatory and predictor, for the variable <span class="math inline">\(x\)</span>? That’s because roughly speaking data modeling can be used for two purposes:</p>
<ol style="list-style-type: decimal">
<li><strong>Modeling for prediction</strong>: You want to predict an outcome variable <span class="math inline">\(y\)</span> based on the information contained in a set of predictor variables. You don’t care so much about understanding how all the variables relate and interact, but so long as you can make good predictions about <span class="math inline">\(y\)</span>, you’re fine. For example, if we know many individuals’ risk factors for lung cancer, such as smoking habits and age, can we predict whether or not they will develop lung cancer? Here we wouldn’t care so much about distinguishing the degree to which the different risk factors contribute to lung cancer, but instead only on whether or not they could be put together to make reliable predictions.</li>
<li><strong>Modeling for explanation</strong>: You want to explicitly describe the relationship between an outcome variable <span class="math inline">\(y\)</span> and a set of explanatory variables, determine the significance of any found relationships, and have measures summarizing these. Continuing our example from above, we would now be interested in describing the individual effects of the different risk factors and quantifying the magnitude of these effects. One reason could be to design an intervention to reduce lung cancer cases in a population, such as targeting smokers of a specific age group with advertisement for smoking cessation programs. In this book, we’ll focus more on this latter purpose.</li>
</ol>
<p>Data modeling is used in a wide variety of fields, including statistical inference, causal inference, artificial intelligence, and machine learning. There are many techniques for data modeling, such as tree-based models, neural networks/deep learning, and more. However, we’ll focus on one particular technique: <em>linear regression</em>, one of the most commonly-used and easy to understand approaches to modeling. Recall our discussion in Chapter <a href="#explore-dataframes"><strong>??</strong></a> on numerical and categorical variables. Linear regression involves:</p>
<ul>
<li>An outcome variable <span class="math inline">\(y\)</span> that is <em>numerical</em></li>
<li>Explanatory variables <span class="math inline">\(\vec{x}\)</span> that are either <em>numerical</em> or <em>categorical</em></li>
</ul>
<p>Whereas there is always only one numerical outcome variable <span class="math inline">\(y\)</span>, we have choices on both the number and the type of explanatory variables <span class="math inline">\(\vec{x}\)</span> to use. We’re going to the following regression scenarios, where we have</p>
<ol style="list-style-type: decimal">
<li>A single numerical explanatory variable <span class="math inline">\(x\)</span> in Chapter @(model1). This scenario is known as <em>simple linear regression</em>.</li>
<li>A single categorical explanatory variable <span class="math inline">\(x\)</span> in Chapter @(model2).</li>
<li>Two numerical explanatory variables <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span> in Chapter @(model3). This is the first of two <em>multiple regression</em> scenarios we’ll cover where there are now more than one explanatory variable.</li>
<li>One numerical and one categorical explanatory variable in Chapter @(model3). This is the second <em>multiple regression</em> scenario we’ll cover. We’ll also introduce <em>interaction models</em> here.</li>
</ol>
<p>We’ll study all 4 of these regression scenarios using real data, all easily accessible via R packages! <!--We will also discuss the concept of *correlation* and how it is frequently incorrectly used to imply *causation*.--></p>
<div id="needed-packages-1" class="section level3 unnumbered">
<h3>Needed packages</h3>
<p>In this chapter we introduce a new package, <code>moderndive</code>, that is an accompaniment package to the ModernDive book that includes useful functions for linear regression and other functions and data used in later in the book. However because this is a relatively new package, we’re have to install this package in a different way than was covered in Section <a href="#packages"><strong>??</strong></a>.</p>
<p>First, install the <code>remotes</code> package like you would normally install a package, then run the following line to install the <code>moderndive</code> package:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(remotes)
<span class="co"># remotes::install_github(&quot;moderndive/moderndive&quot;)</span></code></pre></div>
<p>Let’s now load all the packages needed for this chapter. If needed, read Section <a href="#packages"><strong>??</strong></a> for information on how to install and load R packages.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
<span class="kw">library</span>(dplyr)
<span class="kw">library</span>(moderndive)</code></pre></div>
</div>
<div id="model3" class="section level2">
<h2><span class="header-section-number">3.1</span> Two numerical x</h2>
<p>Much like our teacher evaluation data in Section <a href="2-regression.html#model1">2.1</a>, let’s now attempt to identify factors that are associated with how much credit card debt an individual will hold. The textbook <a href="http://www-bcf.usc.edu/~gareth/ISL/">An Introduction to Statistical Learning with Applications in R</a> by Gareth James, Daniela Witten, Trevor Hastie and Robert Tibshirani is an intermediate-level textbook on statistical and machine learning freely available <a href="http://www-bcf.usc.edu/~gareth/ISL/ISLR%20Seventh%20Printing.pdf">here</a>. It has an accompanying R packaged called <code>ISLR</code> with datasets that the authors use to demonstrate various machine learning methods. One dataset that is frequently used by the authors is the <code>Credit</code> dataset where predictions are made on the balance held by various credit card holders based on information like income, credit limit, and education level. Let’s consider the following variables:</p>
<ul>
<li>Outcome variable <span class="math inline">\(y\)</span>: Credit card balance in dollars</li>
<li>Explanatory variables <span class="math inline">\(x\)</span>:
<ul>
<li>income in $1000’s</li>
<li>credit card limit in dollars</li>
<li>credit rating</li>
<li>card holder’s age</li>
<li>years of education</li>
</ul></li>
</ul>
<p>Let’s load the data and <code>select()</code> only the 6 variables listed above:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ISLR)
Credit &lt;-<span class="st"> </span>Credit <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(Balance, Limit, Income, Rating, Age, Education)</code></pre></div>
<p>Unfortunately, no information on how this data was sampled was provided, so we’re not able to generalize any such results to a greater population, but we will still use this data to demonstrate <em>multiple regression</em>. Multiple regression is a form of linear regression where there are now more than one explanatory variables and thus the interpretation of the associated effect of any one explanatory variable must be made in conjunction with the other explanatory variable. We’ll perform multiple regression with:</p>
<ol style="list-style-type: decimal">
<li>A numerical outcome variable <span class="math inline">\(y\)</span>, in this case teaching credit card <code>Balance</code></li>
<li>Two explanatory variables:
<ol style="list-style-type: decimal">
<li>A first numerical explanatory variable <span class="math inline">\(x_1\)</span>, in this case credit <code>Limit</code></li>
<li>A second numerical explanatory variable <span class="math inline">\(x_2\)</span>, in this case <code>Income</code></li>
</ol></li>
</ol>
<div id="model3EDA" class="section level3">
<h3><span class="header-section-number">3.1.1</span> Exploratory data analysis</h3>
<p>Let’s look at the raw data values both by bringing up RStudio’s spreadsheet viewer, although in Table <a href="3-multiple-regression.html#tab:model3-data-preview">3.1</a> we only show 5 randomly selected credit card holders out of 400, and using the <code>glimpse()</code> function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">View</span>(Credit)</code></pre></div>
<table>
<caption><span id="tab:model3-data-preview">Table 3.1: </span>Random sample of 5 credit card holders</caption>
<thead>
<tr class="header">
<th></th>
<th align="right">Balance</th>
<th align="right">Limit</th>
<th align="right">Income</th>
<th align="right">Rating</th>
<th align="right">Age</th>
<th align="right">Education</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>316</td>
<td align="right">463</td>
<td align="right">3907</td>
<td align="right">14.5</td>
<td align="right">296</td>
<td align="right">43</td>
<td align="right">16</td>
</tr>
<tr class="even">
<td>24</td>
<td align="right">411</td>
<td align="right">5179</td>
<td align="right">64.0</td>
<td align="right">398</td>
<td align="right">48</td>
<td align="right">8</td>
</tr>
<tr class="odd">
<td>117</td>
<td align="right">0</td>
<td align="right">2117</td>
<td align="right">35.2</td>
<td align="right">186</td>
<td align="right">62</td>
<td align="right">16</td>
</tr>
<tr class="even">
<td>183</td>
<td align="right">789</td>
<td align="right">6420</td>
<td align="right">58.9</td>
<td align="right">459</td>
<td align="right">66</td>
<td align="right">9</td>
</tr>
<tr class="odd">
<td>100</td>
<td align="right">1311</td>
<td align="right">8494</td>
<td align="right">83.9</td>
<td align="right">607</td>
<td align="right">47</td>
<td align="right">18</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">glimpse</span>(Credit)</code></pre></div>
<pre><code>Observations: 400
Variables: 6
$ Balance   &lt;int&gt; 333, 903, 580, 964, 331, 1151, 203, 872, 279, 1350, 1407,...
$ Limit     &lt;int&gt; 3606, 6645, 7075, 9504, 4897, 8047, 3388, 7114, 3300, 681...
$ Income    &lt;dbl&gt; 14.9, 106.0, 104.6, 148.9, 55.9, 80.2, 21.0, 71.4, 15.1, ...
$ Rating    &lt;int&gt; 283, 483, 514, 681, 357, 569, 259, 512, 266, 491, 589, 13...
$ Age       &lt;int&gt; 34, 82, 71, 36, 68, 77, 37, 87, 66, 41, 30, 64, 57, 49, 7...
$ Education &lt;int&gt; 11, 15, 11, 11, 16, 10, 12, 9, 13, 19, 14, 16, 7, 9, 13, ...</code></pre>
<p>Let’s look at some summary statistics:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(Credit)</code></pre></div>
<pre><code>    Balance         Limit           Income          Rating         Age      
 Min.   :   0   Min.   :  855   Min.   : 10.4   Min.   : 93   Min.   :23.0  
 1st Qu.:  69   1st Qu.: 3088   1st Qu.: 21.0   1st Qu.:247   1st Qu.:41.8  
 Median : 460   Median : 4622   Median : 33.1   Median :344   Median :56.0  
 Mean   : 520   Mean   : 4736   Mean   : 45.2   Mean   :355   Mean   :55.7  
 3rd Qu.: 863   3rd Qu.: 5873   3rd Qu.: 57.5   3rd Qu.:437   3rd Qu.:70.0  
 Max.   :1999   Max.   :13913   Max.   :186.6   Max.   :982   Max.   :98.0  
   Education   
 Min.   : 5.0  
 1st Qu.:11.0  
 Median :14.0  
 Mean   :13.4  
 3rd Qu.:16.0  
 Max.   :20.0  </code></pre>
<p>We observe for example</p>
<ol style="list-style-type: decimal">
<li>The typical credit card balance is around $500</li>
<li>The typical credit card limit is around $5000</li>
<li>The typical income is around $40,000.</li>
</ol>
<p>Since our outcome variable <code>Balance</code> and the explanatory variables <code>Limit</code> and <code>Rating</code> are numerical, we can compute the correlation coefficient between pairs of these variables. However, instead running the <code>cor()</code> command twice, once for each explanatory variable:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cor</span>(Credit<span class="op">$</span>Balance, Credit<span class="op">$</span>Limit)
<span class="kw">cor</span>(Credit<span class="op">$</span>Balance, Credit<span class="op">$</span>Income)</code></pre></div>
<p>We can simultaneously compute them by returning a <em>correlation matrix</em> in Table <a href="3-multiple-regression.html#tab:model3-correlation">3.2</a>. We read off the correlation coefficient for any pair of variables by looking them up in the appropriate row/column combination.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Credit <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">select</span>(Balance, Limit, Income) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">cor</span>()</code></pre></div>
<table>
<caption><span id="tab:model3-correlation">Table 3.2: </span>Correlations between credit card balance, credit limit, and credit rating</caption>
<thead>
<tr class="header">
<th></th>
<th align="right">Balance</th>
<th align="right">Limit</th>
<th align="right">Income</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Balance</td>
<td align="right">1.000</td>
<td align="right">0.862</td>
<td align="right">0.464</td>
</tr>
<tr class="even">
<td>Limit</td>
<td align="right">0.862</td>
<td align="right">1.000</td>
<td align="right">0.792</td>
</tr>
<tr class="odd">
<td>Income</td>
<td align="right">0.464</td>
<td align="right">0.792</td>
<td align="right">1.000</td>
</tr>
</tbody>
</table>
<p>For example, the correlation coefficients of:</p>
<ol style="list-style-type: decimal">
<li><code>Balance</code> with itself is 1</li>
<li><code>Balance</code> with <code>Limit</code> is 0.862, indicating a strong positive linear relationship, which makes sense as only individuals with large credit limits and accrue large credit card balances.</li>
<li><code>Balance</code> with <code>Income</code> is 0.464, suggestive of another positive linear relationship, although not as strong as the relationship between <code>Balance</code> and <code>Limit</code>.</li>
<li>As an added bonus, we can read off the correlation coefficient of the two explanatory variables, <code>Limit</code> and <code>Income</code> of 0.792. In this case, we say there is a high degree of <em>collinearity</em> between these two explanatory variables.</li>
</ol>
<p>Let’s visualize the relationship of the outcome variable with each of the two explanatory variables in two separate plots</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(Credit, <span class="kw">aes</span>(<span class="dt">x =</span> Limit, <span class="dt">y =</span> Balance)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Credit limit (in $)&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Credit card balance (in $)&quot;</span>, 
       <span class="dt">title =</span> <span class="st">&quot;Relationship between balance and credit limit&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>)
  
<span class="kw">ggplot</span>(Credit, <span class="kw">aes</span>(<span class="dt">x =</span> Income, <span class="dt">y =</span> Balance)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Income (in $1000)&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Credit card balance (in $)&quot;</span>, 
       <span class="dt">title =</span> <span class="st">&quot;Relationship between balance and income&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:2numxplot1"></span>
<img src="ismaykim_files/figure-html/2numxplot1-1.png" alt="Relationship between credit card balance and credit limit/income" width="\textwidth" />
<p class="caption">
Figure 3.1: Relationship between credit card balance and credit limit/income
</p>
</div>
<p>In both cases, there seems to be a positive relationship. However the two plots in Figure <a href="3-multiple-regression.html#fig:2numxplot1">3.1</a> only focus on the relationship of the outcome variable with each of the explanatory variables independently. To get a sense of the <em>joint</em> relationship of all three variables simultaneously through a visualization, let’s display the data in a 3-dimensional (3D) scatterplot, where</p>
<ol style="list-style-type: decimal">
<li>The numerical outcome variable <span class="math inline">\(y\)</span> <code>Balance</code> is on the z-axis (vertical one)</li>
<li>The two numerical explanatory variables form the x and y axes (on the floor). In this case
<ol style="list-style-type: decimal">
<li>The first numerical explanatory variable <span class="math inline">\(x_1\)</span> <code>Income</code> is on the x-axis</li>
<li>The second numerical explanatory variable <span class="math inline">\(x_2\)</span> <code>Limit</code> is on the y-axis</li>
</ol></li>
</ol>
<p>Click on the following image to open an interactive 3D scatterplot in your browser:</p>
<center>
<a target="_blank" href="http://rpubs.com/moderndive/credit_card_balance_3D_scatterplot"><img src="images/credit_card_balance_3D_scatterplot.png" title="3D scatterplot" width="600"/></a>
</center>
<p>Previously in Figure <a href="2-regression.html#fig:numxplot4">2.5</a>, we plotted a “best-fitting” regression line through a set of points where the numerical outcome variable <span class="math inline">\(y\)</span> was teaching <code>score</code> and a single numerical explanatory variable <span class="math inline">\(x\)</span> <code>bty_avg</code>. What is the analogous concept when we have <em>two</em> numerical predictor variables? Instead of a best-fitting line, we now have a best-fitting <em>plane</em>, which is 3D generalization of lines which exist in 2D. Click on the following image to open an interactive plot of the regression plane in your browser.</p>
<center>
<a target="_blank" href="https://beta.rstudioconnect.com/connect/#/apps/3214/"><img src="images/credit_card_balance_regression_plane.png" title="Regression plane" width="600"/></a>
</center>
</div>
<div id="model3table" class="section level3">
<h3><span class="header-section-number">3.1.2</span> Multiple regression</h3>
<p>Just as we did when we had a single numerical explanatory variable <span class="math inline">\(x\)</span> in Section <a href="2-regression.html#model1table">2.1.2</a> and when we had a single categorical explanatory variable <span class="math inline">\(x\)</span> in Section <a href="2-regression.html#model2table">2.2.2</a>, we fit a regression model and obtain the regression table in our two numerical explanatory variable scenario. To fit a regression model and obtain a table using <code>get_regression_table()</code>, we now use a <code>+</code> to consider multiple explanatory variables. In this case since we want to preform a regression of <code>Limit</code> and <code>Income</code> simultaneously, we input <code>Balance ~ Limit + Income</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Balance_model &lt;-<span class="st"> </span><span class="kw">lm</span>(Balance <span class="op">~</span><span class="st"> </span>Limit <span class="op">+</span><span class="st"> </span>Income, <span class="dt">data =</span> Credit)
<span class="kw">get_regression_table</span>(Balance_model)</code></pre></div>
<table>
<caption><span id="tab:model3-table-output">Table 3.3: </span>Multiple regression table</caption>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">std_error</th>
<th align="right">statistic</th>
<th align="right">p_value</th>
<th align="right">conf_low</th>
<th align="right">conf_high</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">intercept</td>
<td align="right">-385.179</td>
<td align="right">19.465</td>
<td align="right">-19.8</td>
<td align="right">0</td>
<td align="right">-423.446</td>
<td align="right">-346.912</td>
</tr>
<tr class="even">
<td align="left">Limit</td>
<td align="right">0.264</td>
<td align="right">0.006</td>
<td align="right">45.0</td>
<td align="right">0</td>
<td align="right">0.253</td>
<td align="right">0.276</td>
</tr>
<tr class="odd">
<td align="left">Income</td>
<td align="right">-7.663</td>
<td align="right">0.385</td>
<td align="right">-19.9</td>
<td align="right">0</td>
<td align="right">-8.420</td>
<td align="right">-6.906</td>
</tr>
</tbody>
</table>
<p>How do we interpret these three values that define the regression plane?</p>
<ul>
<li>Intercept: -$385.18. The intercept in our case represents the credit card balance for an individual who has both a credit <code>Limit</code> of $0 and <code>Income</code> of $0. In our data however, the intercept has limited practical interpretation as no individuals had <code>Limit</code> or <code>Income</code> values of $0 and furthermore the smallest credit card balance was $0. Rather, it is used to situate the regression plane in 3D space.</li>
<li>Limit: $0.26. Now that we have multiple variables to consider, we have to add a caveat to our interpretation: <em>all other things being equal, for every increase of one unit in credit <code>Limit</code> (dollars), there is an associated increase of on average $0.26 in credit card balance</em>. Note:
<ul>
<li>Just as we did in Section <a href="2-regression.html#model1table">2.1.2</a>, we are not making any causal statements, only statements relating to the association between credit limit and balance</li>
<li>The <em>all other things being equal</em> is making a statement about all other explanatory variables, in this case only one: <code>Income</code>. This is equivalent to saying “holding <code>Income</code> constant, we observed an associated increase of $0.26 in credit card balance for every dollar increase in credit limit”</li>
</ul></li>
<li>Income: -$7.66. Similarly, <em>all other things being equal, for every increase of one unit in <code>Income</code> (in other words, $1000 in income), there is an associated decrease of on average $7.66 in credit card balance</em>.</li>
</ul>
<p>However, recall in Figure <a href="3-multiple-regression.html#fig:2numxplot1">3.1</a> that when considered separately, both <code>Limit</code> and <code>Income</code> had positive relationships with the outcome variable <code>Balance</code>: as card holders’ credit limits increased their credit card balances tended to increase as well, and a similar relationship held for incomes and balances. In the above multiple regression, however, the slope for <code>Income</code> is now -7.66, suggesting a <em>negative relationship</em> between income and credit card balance. What explains these contradictory results? This is a phenomenon known as Simpson’s Paradox, a phenomenon in which a trend appears in several different groups of data but disappears or reverses when these groups are combined; we expand on this in Section <a href="3-multiple-regression.html#simpsonsparadox">3.3.1</a>.</p>
</div>
<div id="model3points" class="section level3">
<h3><span class="header-section-number">3.1.3</span> Observed/fitted values and residuals</h3>
<p>As we did previously, in Table <a href="3-multiple-regression.html#tab:model3-points-table">3.4</a> let’s unpack the output of the <code>get_regression_points()</code> function for our model for credit card balance</p>
<ul>
<li>for all 400 card holders in the dataset, in other words</li>
<li>for all 400 rows in the <code>Credit</code> data frame, in other words</li>
<li>for all 400 points</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">regression_points &lt;-<span class="st"> </span><span class="kw">get_regression_points</span>(Balance_model)
regression_points</code></pre></div>
<table>
<caption><span id="tab:model3-points-table">Table 3.4: </span>Regression points (first 5 rows of 400)</caption>
<thead>
<tr class="header">
<th align="right">ID</th>
<th align="right">Balance</th>
<th align="right">Limit</th>
<th align="right">Income</th>
<th align="right">Balance_hat</th>
<th align="right">residual</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">333</td>
<td align="right">3606</td>
<td align="right">14.9</td>
<td align="right">454</td>
<td align="right">-120.8</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">903</td>
<td align="right">6645</td>
<td align="right">106.0</td>
<td align="right">559</td>
<td align="right">344.3</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">580</td>
<td align="right">7075</td>
<td align="right">104.6</td>
<td align="right">683</td>
<td align="right">-103.4</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">964</td>
<td align="right">9504</td>
<td align="right">148.9</td>
<td align="right">986</td>
<td align="right">-21.7</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">331</td>
<td align="right">4897</td>
<td align="right">55.9</td>
<td align="right">481</td>
<td align="right">-150.0</td>
</tr>
</tbody>
</table>
<p>Recall the format of the output:</p>
<ul>
<li><code>balance</code> corresponds to <span class="math inline">\(y\)</span> the observed value</li>
<li><code>balance_hat</code> corresponds to <span class="math inline">\(\widehat{y}\)</span> the fitted value</li>
<li><code>reisdual</code> corresponds to the residual <span class="math inline">\(y - \widehat{y}\)</span></li>
</ul>
<p>As we did in Section <a href="2-regression.html#model1points">2.1.3</a> let’s prove to ourselves that the results make sense by manually replicate the internal computation that <code>get_regression_points()</code> performs using the <code>mutate()</code> verb from Chapter <a href="#wrangling"><strong>??</strong></a></p>
<ol style="list-style-type: decimal">
<li>First we compute a duplicate of the fitted values <span class="math inline">\(\widehat{y} = b_0 + b_1 \times x_1 + b_2 \times x_2\)</span> where the intercept <span class="math inline">\(b_0\)</span> = -385.179, the slope <span class="math inline">\(b_1\)</span> for <code>Limit</code> of 0.264, and the slope <span class="math inline">\(b_2\)</span> for <code>Income</code> of -7.663 and store these in <code>balance_hat_2</code></li>
<li>Then we compute the a duplicated the residuals <span class="math inline">\(y - \widehat{y}\)</span> and store these in <code>residual_2</code></li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">regression_points &lt;-<span class="st"> </span>regression_points <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Balance_hat_2 =</span> <span class="op">-</span><span class="fl">385.179</span> <span class="op">+</span><span class="st"> </span><span class="fl">0.264</span> <span class="op">*</span><span class="st"> </span>Limit <span class="op">-</span><span class="st"> </span><span class="fl">7.663</span> <span class="op">*</span><span class="st"> </span>Income) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">residual_2 =</span> Balance <span class="op">-</span><span class="st"> </span>Balance_hat_<span class="dv">2</span>)
regression_points</code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-51">Table 3.5: </span>Regression points (first five rows)</caption>
<thead>
<tr class="header">
<th align="right">ID</th>
<th align="right">Balance</th>
<th align="right">Limit</th>
<th align="right">Income</th>
<th align="right">Balance_hat</th>
<th align="right">residual</th>
<th align="right">Balance_hat_2</th>
<th align="right">residual_2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">333</td>
<td align="right">3606</td>
<td align="right">14.9</td>
<td align="right">454</td>
<td align="right">-120.8</td>
<td align="right">453</td>
<td align="right">-119.7</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">903</td>
<td align="right">6645</td>
<td align="right">106.0</td>
<td align="right">559</td>
<td align="right">344.3</td>
<td align="right">557</td>
<td align="right">346.4</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">580</td>
<td align="right">7075</td>
<td align="right">104.6</td>
<td align="right">683</td>
<td align="right">-103.4</td>
<td align="right">681</td>
<td align="right">-101.1</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">964</td>
<td align="right">9504</td>
<td align="right">148.9</td>
<td align="right">986</td>
<td align="right">-21.7</td>
<td align="right">983</td>
<td align="right">-18.7</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">331</td>
<td align="right">4897</td>
<td align="right">55.9</td>
<td align="right">481</td>
<td align="right">-150.0</td>
<td align="right">479</td>
<td align="right">-148.4</td>
</tr>
</tbody>
</table>
<p>We see that our manually computed variables <code>balance_hat_2</code> and <code>residual_2</code> equal the original results (up to rounding error).</p>
</div>
<div id="model3residuals" class="section level3">
<h3><span class="header-section-number">3.1.4</span> Residual analysis</h3>
<p>Recall in Section <a href="2-regression.html#model1residuals">2.1.4</a>, our first residual analysis plot investigated the presense of any systematic pattern in the residuals when we had a single numerical predictor: <code>bty_age</code>. For the <code>Credit</code> card dataset, since we have two numerical predictors, <code>Limit</code> and <code>Income</code>, we must perform this twice:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(regression_points, <span class="kw">aes</span>(<span class="dt">x =</span> Limit, <span class="dt">y =</span> residual)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Credit limit (in $)&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Residual&quot;</span>, <span class="dt">title =</span> <span class="st">&quot;Residuals vs credit limit&quot;</span>)
  
<span class="kw">ggplot</span>(regression_points, <span class="kw">aes</span>(<span class="dt">x =</span> Income, <span class="dt">y =</span> residual)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Income (in $1000)&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Residual&quot;</span>, <span class="dt">title =</span> <span class="st">&quot;Residuals vs income&quot;</span>)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-53"></span>
<img src="ismaykim_files/figure-html/unnamed-chunk-53-1.png" alt="Residuals vs credit limit and income" width="\textwidth" />
<p class="caption">
Figure 3.2: Residuals vs credit limit and income
</p>
</div>
<p>In this case, there does appear to be a systematic pattern to the residuals, as the scatter of the residuals around the line <span class="math inline">\(y=0\)</span> is definitely not consistent. This behavior of the residuals is further evidenced by the histogram of residuals in Figure @ref(fig:model3_residuals_hist). We observe that the residuals have a slight right-skew (a long tail towards the right). Ideally, these residuals should be bell-shaped around a residual value of 0.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(regression_points, <span class="kw">aes</span>(<span class="dt">x =</span> residual)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">color =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Residual&quot;</span>)</code></pre></div>
<div class="figure" style="text-align: center">
<img src="ismaykim_files/figure-html/model3_residuals_hist-1.png" alt="Plot of residuals over continent" width="\textwidth" />
<p class="caption">
(#fig:model3_residuals_hist)Plot of residuals over continent
</p>
</div>
<p>Another way to intepret this histogram is that since the residual is computed as <span class="math inline">\(y - \widehat{y}\)</span> = <code>balance</code> - <code>balance_hat</code>, we have some values where the fitted value <span class="math inline">\(\widehat{y}\)</span> is very much lower than the observed value <span class="math inline">\(y\)</span>. In other words, we are underfitting certain credit card holder’s balance by a very large amount.</p>
</div>
<div id="your-turn-2" class="section level3">
<h3><span class="header-section-number">3.1.5</span> Your turn</h3>
<p>Repeat this same analysis but using <code>Age</code> and <code>Rating</code> as the two numerical explanatory variables. Recall the four steps we’ve been following:</p>
<ol style="list-style-type: decimal">
<li>Perform an exploratory data analysis (EDA)</li>
<li>Fit a linear regression model and get information about the model</li>
<li>Get information on all <span class="math inline">\(n\)</span> data points considered in this analysis.</li>
<li>Perform a residual analysis and look for any systematic patterns in the residuals.</li>
</ol>
</div>
</div>
<div id="model4" class="section level2">
<h2><span class="header-section-number">3.2</span> One numerical &amp; one categorical x</h2>
<p>Let’s revisit the instructor evaluation data introduced in Section <a href="2-regression.html#model1">2.1</a>, where we studied the relationship between</p>
<ol style="list-style-type: decimal">
<li>the numerical outcome variable <span class="math inline">\(y\)</span>: instructor evaluation score <code>score</code></li>
<li>the numerical explanatory variable <span class="math inline">\(x\)</span>: beauty score <code>bty_avg</code></li>
</ol>
<p>This analysis suggested that there is a positive relationship between <code>bty_avg</code> and <code>score</code>, in other words as instructors had higher beauty scores, they also tended to have higher teaching evaluation scores. Now let’s say instead of <code>bty_avg</code> we are interested in the numerical explanatory variable <span class="math inline">\(x_1\)</span> <code>age</code> and furthermore we want to use a second <span class="math inline">\(x_2\)</span>, the (binary) categorical variable <code>gender</code>. Our modeling scenario now becomes</p>
<ol style="list-style-type: decimal">
<li>the numerical outcome variable <span class="math inline">\(y\)</span>: instructor evaluation score <code>score</code></li>
<li>Two explanatory variables:
<ol style="list-style-type: decimal">
<li>A first numerical explanatory variable <span class="math inline">\(x_1\)</span>: <code>age</code></li>
<li>A second numerical explanatory variable <span class="math inline">\(x_2\)</span>, in this case <code>gender</code></li>
</ol></li>
</ol>
<div id="model4EDA" class="section level3">
<h3><span class="header-section-number">3.2.1</span> Exploratory data analysis</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># load(url(&quot;http://www.openintro.org/stat/data/evals.RData&quot;))</span>
evals &lt;-<span class="st"> </span>readr<span class="op">::</span><span class="kw">read_csv</span>(<span class="st">&quot;~/Desktop/evals.csv&quot;</span>)
evals &lt;-<span class="st"> </span>evals <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(score, bty_avg, age, gender)</code></pre></div>
<p>We’ve already performed some elements of our exploratory data analysis (EDA) in Section <a href="3-multiple-regression.html#model4EDA">3.2.1</a>, in particular of the outcome variable <code>score</code>, so let’s now only consider our two new explanatory variables</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">evals <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">select</span>(age, gender) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summary</span>()</code></pre></div>
<pre><code>      age          gender         
 Min.   :29.0   Length:463        
 1st Qu.:42.0   Class :character  
 Median :48.0   Mode  :character  
 Mean   :48.4                     
 3rd Qu.:57.0                     
 Max.   :73.0                     </code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cor</span>(evals<span class="op">$</span>score, evals<span class="op">$</span>age)</code></pre></div>
<pre><code>[1] -0.107</code></pre>
<p>In Figure <a href="#numxcatxplot1"><strong>??</strong></a>, we plot a scatterplot of <code>score</code> over <code>age</code>, but given that <code>gender</code> is a binary categorical variable</p>
<ol style="list-style-type: decimal">
<li>We can assign a color to points from each of the two levels of <code>gender</code>: female and male</li>
<li>Furthermore, the <code>geom_smooth(method = &quot;lm&quot;, se = FALSE)</code> layer automatically fits a different regression line for each</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(evals, <span class="kw">aes</span>(<span class="dt">x =</span> age, <span class="dt">y =</span> score, <span class="dt">col =</span> gender)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_jitter</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Age&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Teaching Score&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;Gender&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:numxcatxplot1"></span>
<img src="ismaykim_files/figure-html/numxcatxplot1-1.png" alt="Instructor evaluation scores at UT Austin split by gender: Jittered" width="\textwidth" />
<p class="caption">
Figure 3.3: Instructor evaluation scores at UT Austin split by gender: Jittered
</p>
</div>
<p>We notice some interesting trends:</p>
<ol style="list-style-type: decimal">
<li>There are almost no women faculty over the age of 60.</li>
<li>Fitting separate regression lines for men and women, we see they have different slopes. We see that the associated effect of increasing age seems to be much harsher for women than men. In other words, they have different slopes.</li>
</ol>
</div>
<div id="model4table" class="section level3">
<h3><span class="header-section-number">3.2.2</span> Multiple regression</h3>
<p>Let’s now compute the <em>regression table</em></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">score_model_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">lm</span>(score <span class="op">~</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>gender, <span class="dt">data =</span> evals)
<span class="kw">get_regression_table</span>(score_model_<span class="dv">2</span>)</code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-58">Table 3.6: </span>Regression table</caption>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">std_error</th>
<th align="right">statistic</th>
<th align="right">p_value</th>
<th align="right">conf_low</th>
<th align="right">conf_high</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">intercept</td>
<td align="right">4.484</td>
<td align="right">0.125</td>
<td align="right">35.79</td>
<td align="right">0.000</td>
<td align="right">4.238</td>
<td align="right">4.730</td>
</tr>
<tr class="even">
<td align="left">age</td>
<td align="right">-0.009</td>
<td align="right">0.003</td>
<td align="right">-3.28</td>
<td align="right">0.001</td>
<td align="right">-0.014</td>
<td align="right">-0.003</td>
</tr>
<tr class="odd">
<td align="left">gendermale</td>
<td align="right">0.191</td>
<td align="right">0.052</td>
<td align="right">3.63</td>
<td align="right">0.000</td>
<td align="right">0.087</td>
<td align="right">0.294</td>
</tr>
</tbody>
</table>
<p>The modeling equation for this is:</p>
<p><span class="math display">\[
\begin{align}
\widehat{y} &amp;= b_0 + b_1 x_1 + b_2 x_2 \\
\widehat{score} &amp;= b_0 + b_{age} age + b_{male} \mathbb{1}[\mbox{is male}] \\
\end{align}
\]</span></p>
<p>What this looks like is in Figure <a href="3-multiple-regression.html#fig:numxcatxplot2">3.4</a> below.</p>
<div class="figure" style="text-align: center"><span id="fig:numxcatxplot2"></span>
<img src="ismaykim_files/figure-html/numxcatxplot2-1.png" alt="Instructor evaluation scores at UT Austin by gender: same slope" width="\textwidth" />
<p class="caption">
Figure 3.4: Instructor evaluation scores at UT Austin by gender: same slope
</p>
</div>
<p>We see that:</p>
<ul>
<li>Females are treated as the baseline for comparison for no other reason than “female” is alphabetically earlier than “male”. The <span class="math inline">\(b_{male} = 0.1906\)</span> is the vertical “bump” that men get in their teaching evaluation scores. Or more precisely, it is the average difference in teaching score that men get <em>relative to the baseline of women</em></li>
<li>Accordingly, the intercepts are (which in this case make no sense since no instructor can have age 0):
<ul>
<li>for women: <span class="math inline">\(b_0\)</span> = 4.484</li>
<li>for men: <span class="math inline">\(b_0 + b_{male}\)</span> = 4.484 + 0.191 = 4.675</li>
</ul></li>
<li>Both men and women have the same slope. In other words, <em>in this model</em> the associated effect of age is the same for men and women: all other things being equal, for every increase in 1 in age, there is on average an associated decrease of <span class="math inline">\(b_{age}\)</span> = -0.0086 in teaching score</li>
</ul>
<p><strong>Hold up</strong>: Figure <a href="3-multiple-regression.html#fig:numxcatxplot2">3.4</a> is different than Figure <a href="3-multiple-regression.html#fig:numxcatxplot1">3.3</a>! What is going on? What we have in the original plot is an <em>interaction effect</em> between age and gender!</p>
</div>
<div id="mutiple-regression-with-interaction-effects" class="section level3">
<h3><span class="header-section-number">3.2.3</span> Mutiple regression with interaction effects</h3>
</div>
<div id="model4points" class="section level3">
<h3><span class="header-section-number">3.2.4</span> Observed/fitted values and residuals</h3>
<p>We say a model has an interaction effect if the associated effect of one variable <em>depends on the value of another variable</em>.</p>
<p>Let’s now compute the <em>regression table</em></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">score_model_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">lm</span>(score <span class="op">~</span><span class="st"> </span>age <span class="op">*</span><span class="st"> </span>gender, <span class="dt">data =</span> evals)
<span class="kw">get_regression_table</span>(score_model_<span class="dv">2</span>)</code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-60">Table 3.7: </span>Regression table</caption>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">std_error</th>
<th align="right">statistic</th>
<th align="right">p_value</th>
<th align="right">conf_low</th>
<th align="right">conf_high</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">intercept</td>
<td align="right">4.484</td>
<td align="right">0.125</td>
<td align="right">35.79</td>
<td align="right">0.000</td>
<td align="right">4.238</td>
<td align="right">4.730</td>
</tr>
<tr class="even">
<td align="left">age</td>
<td align="right">-0.009</td>
<td align="right">0.003</td>
<td align="right">-3.28</td>
<td align="right">0.001</td>
<td align="right">-0.014</td>
<td align="right">-0.003</td>
</tr>
<tr class="odd">
<td align="left">gendermale</td>
<td align="right">0.191</td>
<td align="right">0.052</td>
<td align="right">3.63</td>
<td align="right">0.000</td>
<td align="right">0.087</td>
<td align="right">0.294</td>
</tr>
</tbody>
</table>
<p>The model formula is</p>
<p><span class="math display">\[
\begin{align}
\widehat{y} &amp;= b_0 + b_1 x_1 + b_2 x_2 + b_3 x_1x_2\\
\widehat{score} &amp;= b_0 + b_{age} age + b_{male} \mathbb{1}[\mbox{is male}] + b_{age,male}age\mathbb{1}[\mbox{is male}] \\
\end{align}
\]</span></p>
</div>
<div id="model4residuals" class="section level3">
<h3><span class="header-section-number">3.2.5</span> Residual analysis</h3>
<!--
## Two categorical $x$ {#model5}

Let's look at the `biopics` dataset in the
[`fivethirtyeight`](https://rudeboybert.github.io/fivethirtyeight/) package.
After loading the package, run `?biopics` in the console to read the help file.
This data is from the article ["Straight Outta Compton" Is The Rare Biopic Not About White Dudes](https://fivethirtyeight.com/features/straight-outta-compton-is-the-rare-biopic-not-about-white-dudes/).  

First let's load the data and look at a random sample of 5 rows:


```r
library(fivethirtyeight)
biopics <- biopics %>%
  select(title, box_office, person_of_color, subject_sex) %>%
  # Remove those that are missing
  filter(!is.na(box_office))
```


title                  box_office  person_of_color   subject_sex 
--------------------  -----------  ----------------  ------------
Nostradamus                364000  FALSE             Male        
Nora                        12300  FALSE             Male        
Swoon                      340000  FALSE             Male        
Salome's Last Dance        331000  FALSE             Male        
Monster                  34500000  FALSE             Female      




Before we conduct an exploratory data analysis (EDA) of the `biopics` data, let's first
have a discussion $\log$-transformations.

### log-transformations

Let's consider a histogram of the box office revenues for the `biopics` dataset


```r
ggplot(biopics, aes(x = box_office)) +
  geom_histogram(color = "white") +
  labs(x = "Box office revenue")
```

<div class="figure" style="text-align: center">
<img src="ismaykim_files/figure-html/logtransform1-1.png" alt="Histogram of box office revenue" width="\textwidth" />
<p class="caption">(\#fig:logtransform1)Histogram of box office revenue</p>
</div>

In Figure \@ref(fig:logtransform1), we see there is a right-skew to both the
x-values. This is because there are a few Hollywood blockbusters being compared
with many (likely) smaller-scale independent films. Let's look at the top 5 and
bottom 5 grossing movies in this dataset: 


Table: (\#tab:unnamed-chunk-63)Top 5 grossing movies in data

title                  box_office  person_of_color   subject_sex 
--------------------  -----------  ----------------  ------------
American Sniper         350000000  FALSE             Male        
The Blind Side          256000000  TRUE              Male        
Lincoln                 182000000  FALSE             Male        
A Beautiful Mind        171000000  FALSE             Male        
Catch Me If You Can     164000000  FALSE             Male        


Table: (\#tab:unnamed-chunk-64)Bottom 5 grossing movies in data

title                    box_office  person_of_color   subject_sex 
----------------------  -----------  ----------------  ------------
Caravaggio                     3150  FALSE             Male        
Set Fire to the Stars          3270  FALSE             Male        
My Dinner with Andre           5070  FALSE             Male        
My Dinner with Andre           5070  FALSE             Male        
Kid Cannabis                   5570  FALSE             Male        

The scale of box office revenue is completely different! Hence, in Figure \@ref(fig:logtransform1), it's really hard to see what's going on at the
lower-end. 

Let's unskew this variable and compare not *absolute* differences, but rather,
*relative* differences i.e. differences in "order of magnitude" using a
`log10()` transformation:


```r
ggplot(biopics, aes(x = log10(box_office))) +
  geom_histogram(color = "white") +
  labs(x = "log10(Box office revenue)")
```

<div class="figure" style="text-align: center">
<img src="ismaykim_files/figure-html/logtransform2-1.png" alt="Histogram of log10(box office revenue)" width="\textwidth" />
<p class="caption">(\#fig:logtransform2)Histogram of log10(box office revenue)</p>
</div>

We can see a little better what's going on at the lower end of the box office revenue scale.
However the values on the axes require a little thinking to process. For example
at $x=7$, this corresponds to movies with revenue of $10^7 = 10,000,000$
dollars. So instead, let's *rescale* the x-axis so that it displays the data in
their original units.


```r
ggplot(biopics, aes(x = box_office)) +
  geom_histogram(color = "white") +
  scale_x_log10() +
  labs(x = "Box office revenue (log10-scale))")
```

<div class="figure" style="text-align: center">
<img src="ismaykim_files/figure-html/logtransform3-1.png" alt="Histogram of box office revenue (log-10 scale)" width="\textwidth" />
<p class="caption">(\#fig:logtransform3)Histogram of box office revenue (log-10 scale)</p>
</div>

Note that

* The two plots are identical, but the values on the x-axis are different.
* In both Figure \@ref(fig:logtransform2) Figure \@ref(fig:logtransform3), equivalent distances on each axes correspond to not equivalent absolute differences, but equivalent relative/multiplicative differences. So for example, the horizontal distance on the plot from Budget = `1e+05` = $10^5$ to Budget  = `1e+06` = $10^6$ is equal to the horizontal distance on the plot from Budget = `1e+06` = $10^6$ to Budget = `1e+07` = $10^7$.



### Exploratory data analysis {#model5EDA}

Let's now consider the box office gross earnings in the US of these movies on a log10
scale:


```r
ggplot(biopics, aes(x = subject_sex, y = box_office)) +
  facet_wrap(~person_of_color, nrow = 1) +
  scale_y_log10() +
  geom_boxplot() +
  labs(x = "Subject sex", y = "Box office revenue (log10-scale)", title =
  "Person of color?")
```

<div class="figure" style="text-align: center">
<img src="ismaykim_files/figure-html/2catxplot-1.png" alt="Box office revenue vs biopic subject info" width="\textwidth" />
<p class="caption">(\#fig:2catxplot)Box office revenue vs biopic subject info</p>
</div>

It seems in this dataset, men of color had the highest median box office gross. Let's
look at a table of means instead of medians.


```r
biopics %>%
  group_by(person_of_color, subject_sex) %>%
  summarise(mean_box_office = mean(box_office)) %>%
  arrange(desc(mean_box_office))
```

Table: (\#tab:unnamed-chunk-66)Group means

person_of_color   subject_sex    mean_box_office
----------------  ------------  ----------------
TRUE              Male                  31648028
FALSE             Male                  22871074
TRUE              Female                20035820
FALSE             Female                18088799

Keep in mind two things though. First, the sample sizes are different:


```r
biopics %>%
  group_by(person_of_color, subject_sex) %>%
  summarise(n = n()) %>%
  arrange(desc(n))
```

Table: (\#tab:unnamed-chunk-68)Number of movies of each type in dataset

person_of_color   subject_sex      n
----------------  ------------  ----
FALSE             Male           268
FALSE             Female          93
TRUE              Male            61
TRUE              Female          15

Second, can we *generalize* these results to *all movies*? How was the selection
of movies sampled? Is it a representative sample of all movies, or was their a
systematic reason these were included?



### Multiple regression {#model5table}


Let's now compute the *regression table*. Let's jump straight into considering
a model that incorporates an interaction term as described earlier. 


```r
box_office_model <- lm(box_office ~ person_of_color * subject_sex, data = biopics)
get_regression_table(box_office_model)
```

Table: (\#tab:unnamed-chunk-70)Regression table

term                                   estimate   std_error   statistic   p_value    conf_low   conf_high
------------------------------------  ---------  ----------  ----------  --------  ----------  ----------
intercept                              18088799     3964762       4.562     0.000    10296227    25881371
person_of_colorTRUE                     1947021    10638573       0.183     0.855   -18962645    22856687
subject_sexMale                         4782275     4601541       1.039     0.299    -4261860    13826410
person_of_colorTRUE:subject_sexMale     6829933    11941509       0.572     0.568   -16640597    30300464

The model formula is

$$
\begin{align}
\widehat{y} &= b_0 + b_1 x_1 + b_2 x_2 + b_3 x_1x_2\\
\widehat{score} &= b_0 + b_{color}\mathbb{1}[\mbox{of color}] + b_{male} \mathbb{1}[\mbox{is male}] + b_{color,male}\mathbb{1}[\mbox{of color}]\mathbb{1}[\mbox{is male}] \\
\end{align}
$$


Recreate four group means from the Table 6.15 above:

* Female not of color: 18088799 = 18088799 = $b_0$. Note: *Women not of color are the baseline group*.
* Male not of color: 22871074 = 18088799 + 4782275 = $b_0 + b_{male}$
* Female of color: 20035820 = 18088799 + 1947021 = $b_0 + b_{color}$
* Male of color: 31648028 = 18088799 + 1947021 + 4782275 + 6829933 = $b_0 + b_{color} + b_{male} + b_{color,male}$. Note: $b_{color,male}$ is the *interaction term*.






### Observed/fitted values and residuals {#model5points}
### Residual analysis {#model5residuals}

-->
</div>
</div>
<div id="other-topics-1" class="section level2">
<h2><span class="header-section-number">3.3</span> Other topics</h2>
<div id="simpsonsparadox" class="section level3">
<h3><span class="header-section-number">3.3.1</span> Simpson’s Paradox</h3>
<p>Recall in Section <a href="3-multiple-regression.html#model3">3.1</a>, we saw the two following seemingly contraditory results when studying the relationship between credit card balance, credit limit, and income. On the one hand, the right hand plot of Figure <a href="3-multiple-regression.html#fig:2numxplot1">3.1</a> suggested that credit card balance and income were positively related:</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-71"></span>
<img src="ismaykim_files/figure-html/unnamed-chunk-71-1.png" alt="Relationship between credit card balance and credit limit/income" width="\textwidth" />
<p class="caption">
Figure 3.5: Relationship between credit card balance and credit limit/income
</p>
</div>
<p>On the other hand, the multiple regression in Table <a href="3-multiple-regression.html#tab:model3-table-output">3.3</a>, suggested that when modeling credit card balance as a function of both credit limit and income at the same time, credit limit has a negative relationship with balance, as evidenced by the slope of -7.66. How can this be?</p>
<p>First, let’s dive a little deeper into the explanatory variable <code>Limit</code>. Figure @ref(fig:credit_limit_quartiles) shows a histogram of all 400 values of <code>Limit</code>, along with vertical red lines that cut up the data into quartiles, meaning:</p>
<ol style="list-style-type: decimal">
<li>25% of credit limits were between $0 and $3088. Let’s call this the “low” credit limit bracket.</li>
<li>25% of credit limits were between $3088 and $4622. Let’s call this the “medium-low” credit limit bracket.</li>
<li>25% of credit limits were between $4622 and $5873. Let’s call this the “medium-high” credit limit bracket.</li>
<li>25% of credit limits were over $5873. Let’s call this the “high” credit limit bracket.</li>
</ol>
<div class="figure" style="text-align: center">
<img src="ismaykim_files/figure-html/credit_limit_quartiles-1.png" alt="Histogram of credit limits and quartiles" width="\textwidth" />
<p class="caption">
(#fig:credit_limit_quartiles)Histogram of credit limits and quartiles
</p>
</div>
<p>Let’s now display</p>
<ol style="list-style-type: decimal">
<li>The scatterplot showing the relationship between credit card balance and limit (the right-hand plot of Figure <a href="3-multiple-regression.html#fig:2numxplot1">3.1</a>).</li>
<li>The scatterplot showing the relationship between credit card balance and limit now with a color aesthetic added corresponding to the credit limit bracket.</li>
</ol>
<div class="figure" style="text-align: center"><span id="fig:2numxplot4"></span>
<img src="ismaykim_files/figure-html/2numxplot4-1.png" alt="Relationship between credit card balance and income for different credit limit brackets" width="\textwidth" />
<p class="caption">
Figure 3.6: Relationship between credit card balance and income for different credit limit brackets
</p>
</div>
<p>The left-hand plot focuses of the relationship between balance and income in aggregate, but the right-hand plot focuses on the relationship between balance and income <em>broken down by credit limit bracket</em>. Whereas in aggregate there is an overall positive relationship, but when broken down We now see that for the</p>
<ol style="list-style-type: decimal">
<li>low</li>
<li>medium-low</li>
<li>medium-high</li>
</ol>
<p>income bracket groups, the strong positive relationship between credit card balance and income disappears! Only for the high bracket does the relationship stay somewhat positive. In this example credit limit is a <em>confounding variable</em> for credit card balance and income.</p>
<!--
Alternatively, we could also have used facets, where each facet has roughly 25% of people based
on the credit limit bracket. However, IMO the above plot is easier to read.

<div class="figure" style="text-align: center">
<img src="ismaykim_files/figure-html/2numxplot5-1.png" alt="Relationship between credit card balance and income for different credit limit brackets" width="\textwidth" />
<p class="caption">(\#fig:2numxplot5)Relationship between credit card balance and income for different credit limit brackets</p>
</div>
-->
</div>
<div id="script-of-r-code-1" class="section level3">
<h3><span class="header-section-number">3.3.2</span> Script of R code</h3>
<p>An R script file of all R code used in this chapter is available <a href="https://moderndive.netlify.com/scripts/07-multiple-regression.R">here</a>.</p>

<div id="refs" class="references">
<div>
<p>Chihara, Laura M., and Tim C. Hesterberg. 2011. <em>Mathematical Statistics with Resampling and R</em>. Hoboken, NJ: John Wiley; Sons. <a href="https://sites.google.com/site/chiharahesterberg/home" class="uri">https://sites.google.com/site/chiharahesterberg/home</a>.</p>
</div>
<div>
<p>Diez, David M, Christopher D Barr, and Mine Çetinkaya-Rundel. 2014. <em>Introductory Statistics with Randomization and Simulation</em>. First Edition. <a href="https://www.openintro.org/stat/textbook.php?stat_book=isrs" class="uri">https://www.openintro.org/stat/textbook.php?stat_book=isrs</a>.</p>
</div>
<div>
<p>Grolemund, Garrett, and Hadley Wickham. 2016. <em>R for Data Science</em>. <a href="http://r4ds.had.co.nz/" class="uri">http://r4ds.had.co.nz/</a>.</p>
</div>
<div>
<p>Xie, Yihui. 2017. <em>Bookdown: Authoring Books and Technical Documents with R Markdown</em>. <a href="https://CRAN.R-project.org/package=bookdown" class="uri">https://CRAN.R-project.org/package=bookdown</a>.</p>
</div>
</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="2-regression.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/ismayc/moderndiver-book/edit/master/07-multiple-regression.Rmd",
"text": "Edit"
},
"download": null,
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
